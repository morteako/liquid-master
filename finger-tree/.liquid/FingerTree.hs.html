<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>C:\Users\MortenAske\Dropbox\master\finger-tree\FingerTree.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>   1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE CPP #-}</span></a>
<span class=hs-linenum>   2: </span><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<span class=hs-linenum>   3: </span><span class='hs-comment'>{-# LANGUAGE FunctionalDependencies #-}</span>
<span class=hs-linenum>   4: </span><span class='hs-comment'>{-# LANGUAGE MultiParamTypeClasses #-}</span>
<span class=hs-linenum>   5: </span><span class='hs-comment'>{-# LANGUAGE UndecidableInstances #-}</span>
<span class=hs-linenum>   6: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 702</span>
<span class=hs-linenum>   7: </span><span class='hs-comment'>{-# LANGUAGE Safe #-}</span>
<span class=hs-linenum>   8: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>   9: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum>  10: </span><span class='hs-comment'>{-# LANGUAGE DeriveGeneric #-}</span>
<span class=hs-linenum>  11: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  12: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 710</span>
<span class=hs-linenum>  13: </span><span class='hs-comment'>{-# LANGUAGE AutoDeriveTypeable #-}</span>
<span class=hs-linenum>  14: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  15: </span><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<span class=hs-linenum>  16: </span><span class='hs-comment'>-- |</span>
<span class=hs-linenum>  17: </span><span class='hs-comment'>-- Module      :  Data.FingerTree</span>
<span class=hs-linenum>  18: </span><span class='hs-comment'>-- Copyright   :  (c) Ross Paterson, Ralf Hinze 2006</span>
<span class=hs-linenum>  19: </span><span class='hs-comment'>-- License     :  BSD-style</span>
<span class=hs-linenum>  20: </span><span class='hs-comment'>-- Maintainer  :  R.Paterson@city.ac.uk</span>
<span class=hs-linenum>  21: </span><span class='hs-comment'>-- Stability   :  experimental</span>
<span class=hs-linenum>  22: </span><span class='hs-comment'>-- Portability :  non-portable (MPTCs and functional dependencies)</span>
<span class=hs-linenum>  23: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  24: </span><span class='hs-comment'>-- A general sequence representation with arbitrary annotations, for</span>
<span class=hs-linenum>  25: </span><span class='hs-comment'>-- use as a base for implementations of various collection types, as</span>
<span class=hs-linenum>  26: </span><span class='hs-comment'>-- described in section 4 of</span>
<span class=hs-linenum>  27: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  28: </span><span class='hs-comment'>--  * Ralf Hinze and Ross Paterson,</span>
<span class=hs-linenum>  29: </span><span class='hs-comment'>--    \"Finger trees: a simple general-purpose data structure\",</span>
<span class=hs-linenum>  30: </span><span class='hs-comment'>--    /Journal of Functional Programming/ 16:2 (2006) pp 197-217.</span>
<span class=hs-linenum>  31: </span><span class='hs-comment'>--    &lt;<a href="http://staff.city.ac.uk/~ross/papers/FingerTree.html">http://staff.city.ac.uk/~ross/papers/FingerTree.html</a>&gt;</span>
<span class=hs-linenum>  32: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  33: </span><span class='hs-comment'>-- For a directly usable sequence type, see @Data.Sequence@, which is</span>
<span class=hs-linenum>  34: </span><span class='hs-comment'>-- a specialization of this structure.</span>
<span class=hs-linenum>  35: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  36: </span><span class='hs-comment'>-- An amortized running time is given for each operation, with /n/</span>
<span class=hs-linenum>  37: </span><span class='hs-comment'>-- referring to the length of the sequence.  These bounds hold even in</span>
<span class=hs-linenum>  38: </span><span class='hs-comment'>-- a persistent (shared) setting.</span>
<span class=hs-linenum>  39: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  40: </span><span class='hs-comment'>-- /Note/: Many of these operations have the same names as similar</span>
<span class=hs-linenum>  41: </span><span class='hs-comment'>-- operations on lists in the "Prelude".  The ambiguity may be resolved</span>
<span class=hs-linenum>  42: </span><span class='hs-comment'>-- using either qualification or the @hiding@ clause.</span>
<span class=hs-linenum>  43: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  44: </span><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<span class=hs-linenum>  45: </span>
<span class=hs-linenum>  46: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span><span class='hs-layout'>,</span> <span class='hs-varid'>reverse</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  47: </span><span class='hs-cpp'>#if MIN_VERSION_base(4,6,0)</span>
<span class=hs-linenum>  48: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Generics</span>
<span class=hs-linenum>  49: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  50: </span><span class='hs-cpp'>#if MIN_VERSION_base(4,8,0)</span>
<span class=hs-linenum>  51: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Prelude</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  52: </span><span class='hs-cpp'>#else</span>
<span class=hs-linenum>  53: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Applicative</span> <span class='hs-layout'>(</span><span class='hs-conid'>Applicative</span><span class='hs-layout'>(</span><span class='hs-varid'>pure</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;*&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;$&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  54: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Monoid</span>
<span class=hs-linenum>  55: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Foldable</span><span class='hs-layout'>(</span><span class='hs-varid'>foldMap</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  56: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  57: </span><span class='hs-cpp'>#if (MIN_VERSION_base(4,9,0)) &amp;&amp; !(MIN_VERSION_base(4,11,0))</span>
<span class=hs-linenum>  58: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Semigroup</span>
<span class=hs-linenum>  59: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  60: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Foldable</span> <span class='hs-layout'>(</span><span class='hs-varid'>toList</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  61: </span>
<span class=hs-linenum>  62: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span> <span class='hs-varop'>&gt;&lt;</span>
<span class=hs-linenum>  63: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span> <span class='hs-varop'>&lt;|</span><span class='hs-layout'>,</span> <span class='hs-conop'>:&lt;</span>
<span class=hs-linenum>  64: </span><span class='hs-keyword'>infixl</span> <span class='hs-num'>5</span> <span class='hs-varop'>|&gt;</span><span class='hs-layout'>,</span> <span class='hs-conop'>:&gt;</span>
<span class=hs-linenum>  65: </span>
<span class=hs-linenum>  66: </span><span class='hs-comment'>-- | View of the left end of a sequence.</span>
<span class=hs-linenum>  67: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.ViewL a##xo b##xo)
-&gt; (GHC.Generics.Rep (Main.ViewL a##xo b##xo) c##xo)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>ViewL</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>  68: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyL</span>        <span class='hs-comment'>-- ^ empty sequence</span>
<span class=hs-linenum>  69: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span>      <span class='hs-comment'>-- ^ leftmost element and the rest of the sequence</span>
<span class=hs-linenum>  70: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span>
<span class=hs-linenum>  71: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum>  72: </span>        <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(GHC.Generics.Generic (Main.ViewL a##xo b##xo))</span><span class='hs-conid'>Generic</span></a>
<span class=hs-linenum>  73: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  74: </span>        <span class='hs-layout'>)</span>
<span class=hs-linenum>  75: </span>
<span class=hs-linenum>  76: </span><span class='hs-comment'>-- | View of the right end of a sequence.</span>
<span class=hs-linenum>  77: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.ViewR a##xo b##xo)
-&gt; (GHC.Generics.Rep (Main.ViewR a##xo b##xo) c##xo)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>ViewR</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>  78: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyR</span>        <span class='hs-comment'>-- ^ empty sequence</span>
<span class=hs-linenum>  79: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>a</span>      <span class='hs-comment'>-- ^ the sequence minus the rightmost element,</span>
<span class=hs-linenum>  80: </span>                    <span class='hs-comment'>-- and the rightmost element</span>
<span class=hs-linenum>  81: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span>
<span class=hs-linenum>  82: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum>  83: </span>        <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(GHC.Generics.Generic (Main.ViewR a##xo b##xo))</span><span class='hs-conid'>Generic</span></a>
<span class=hs-linenum>  84: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  85: </span>        <span class='hs-layout'>)</span>
<span class=hs-linenum>  86: </span>
<span class=hs-linenum>  87: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Functor</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Functor</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewL</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  88: </span>    <span class='hs-varid'>fmap</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>EmptyL</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyL</span>
<span class=hs-linenum>  89: </span>    <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>  90: </span>
<span class=hs-linenum>  91: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Functor</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Functor</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewR</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  92: </span>    <span class='hs-varid'>fmap</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>EmptyR</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyR</span>
<span class=hs-linenum>  93: </span>    <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>xs</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>xs</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>  94: </span>
<span class=hs-linenum>  95: </span><span class='hs-cpp'>#if MIN_VERSION_base(4,9,0)</span>
<span class=hs-linenum>  96: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(GHC.Base.Semigroup (Main.FingerTree a##xo b##xo))</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Semigroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  97: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  98: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  99: </span>
<span class=hs-linenum> 100: </span><span class='hs-comment'>-- | 'empty' and '&gt;&lt;'.</span>
<span class=hs-linenum> 101: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(GHC.Base.Monoid (Main.FingerTree a##xo b##xo))</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Monoid</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 102: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>mempty</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>empty</span></a>
<span class=hs-linenum> 103: </span><span class='hs-cpp'>#if !(MIN_VERSION_base(4,11,0))</span>
<span class=hs-linenum> 104: </span>    <span class='hs-varid'>mappend</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 105: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 106: </span>
<span class=hs-linenum> 107: </span><span class='hs-comment'>-- Explicit Digit type (Exercise 1)</span>
<span class=hs-linenum> 108: </span>
<span class=hs-linenum> 109: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Digit a##xo)
-&gt; (GHC.Generics.Rep (Main.Digit a##xo) b##xo)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 110: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 111: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 112: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 113: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 114: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span>
<span class=hs-linenum> 115: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum> 116: </span>        <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>forall a##xo . (GHC.Generics.Generic (Main.Digit a##xo))</span><span class='hs-conid'>Generic</span></a>
<span class=hs-linenum> 117: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 118: </span>        <span class='hs-layout'>)</span>
<span class=hs-linenum> 119: </span>
<span class=hs-linenum> 120: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-conid'>Digit</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 121: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 122: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 123: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 124: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>c</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 125: </span>
<span class=hs-linenum> 126: </span><span class='hs-comment'>-------------------</span>
<span class=hs-linenum> 127: </span><span class='hs-comment'>-- 4.1 Measurements</span>
<span class=hs-linenum> 128: </span><span class='hs-comment'>-------------------</span>
<span class=hs-linenum> 129: </span>
<span class=hs-linenum> 130: </span><span class='hs-comment'>-- | Things that can be measured.</span>
<span class=hs-linenum> 131: </span><span class='hs-keyword'>class</span> <span class='hs-layout'>(</span><span class='hs-conid'>Monoid</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 132: </span>    <span class='hs-varid'>measure</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span>
<span class=hs-linenum> 133: </span>
<span class=hs-linenum> 134: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Measured a##xo (Main.Digit b##xo))</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 135: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Digit b##xo)
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo)
-&gt; (Main.Digit a##xo)
   -&gt; b##xo</span><span class='hs-varid'>foldMap</span></a> <span class='hs-varid'>measure</span>
<span class=hs-linenum> 136: </span>
<span class=hs-linenum> 137: </span><span class='hs-comment'>---------------------------</span>
<span class=hs-linenum> 138: </span><span class='hs-comment'>-- 4.2 Caching measurements</span>
<span class=hs-linenum> 139: </span><span class='hs-comment'>---------------------------</span>
<span class=hs-linenum> 140: </span>
<span class=hs-linenum> 141: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.Node a##xo b##xo)
-&gt; (GHC.Generics.Rep (Main.Node a##xo b##xo) c##xo)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Node2</span> <span class='hs-varop'>!</span><span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node3</span> <span class='hs-varop'>!</span><span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 142: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span>
<span class=hs-linenum> 143: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum> 144: </span>        <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo . (GHC.Generics.Generic (Main.Node a##xo b##xo))</span><span class='hs-conid'>Generic</span></a>
<span class=hs-linenum> 145: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 146: </span>        <span class='hs-layout'>)</span>
<span class=hs-linenum> 147: </span>
<span class=hs-linenum> 148: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 149: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 150: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 151: </span>
<span class=hs-linenum> 152: </span><span class='hs-definition'>node2</span>        <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 153: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
b##xo
-&gt; b##xo
   -&gt; (Main.Node a##xo b##xo)</span><span class='hs-definition'>node2</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a>    <span class='hs-keyglyph'>=</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-conid'>Node2</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 154: </span>
<span class=hs-linenum> 155: </span><span class='hs-definition'>node3</span>        <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 156: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
b##xo
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.Node a##xo b##xo)</span><span class='hs-definition'>node3</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>c</span></a>  <span class='hs-keyglyph'>=</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-conid'>Node3</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 157: </span>
<span class=hs-linenum> 158: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(GHC.Base.Monoid&lt;[]&gt; a##xo) =&gt;
(Main.Measured a##xo (Main.Node a##xo b##xo))</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Monoid</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 159: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(GHC.Base.Monoid&lt;[]&gt; a##xo) =&gt;
(Main.Node a##xo b##xo)
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>v</span>
<span class=hs-linenum> 160: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>v</span>
<span class=hs-linenum> 161: </span>
<span class=hs-linenum> 162: </span><span class='hs-definition'>nodeToDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 163: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Node a##xo b##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-definition'>nodeToDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 164: </span><span class='hs-definition'>nodeToDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 165: </span>
<span class=hs-linenum> 166: </span><span class='hs-comment'>-- | A representation of a sequence of values of type @a@, allowing</span>
<span class=hs-linenum> 167: </span><span class='hs-comment'>-- access to the ends in constant time, and append and split in time</span>
<span class=hs-linenum> 168: </span><span class='hs-comment'>-- logarithmic in the size of the smaller piece.</span>
<span class=hs-linenum> 169: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 170: </span><span class='hs-comment'>-- The collection is also parameterized by a measure type @v@, which</span>
<span class=hs-linenum> 171: </span><span class='hs-comment'>-- is used to specify a position in the sequence for the 'split' operation.</span>
<span class=hs-linenum> 172: </span><span class='hs-comment'>-- The types of the operations enforce the constraint @'Measured' v a@,</span>
<span class=hs-linenum> 173: </span><span class='hs-comment'>-- which also implies that the type @v@ is determined by @a@.</span>
<span class=hs-linenum> 174: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 175: </span><span class='hs-comment'>-- A variety of abstract data types can be implemented by using different</span>
<span class=hs-linenum> 176: </span><span class='hs-comment'>-- element types and measurements.</span>
<span class=hs-linenum> 177: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.FingerTree a##xo b##xo)
-&gt; (GHC.Generics.Rep (Main.FingerTree a##xo b##xo) c##xo)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 178: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 179: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 180: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Deep</span> <span class='hs-varop'>!</span><span class='hs-varid'>v</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 181: </span><span class='hs-cpp'>#if TESTING</span>
<span class=hs-linenum> 182: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span>
<span class=hs-linenum> 183: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum> 184: </span>        <span class='hs-layout'>,</span> <span class='hs-conid'>Generic</span>
<span class=hs-linenum> 185: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 186: </span>        <span class='hs-layout'>)</span>
<span class=hs-linenum> 187: </span><span class='hs-cpp'>#elif __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum> 188: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(GHC.Generics.Generic (Main.FingerTree a##xo b##xo))</span><span class='hs-conid'>Generic</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 189: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 190: </span>
<span class=hs-linenum> 191: </span><span class='hs-definition'>deep</span> <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 192: </span>     <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 193: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Digit b##xo)
-&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>deep</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>pr</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>sf</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 194: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 195: </span>
<span class=hs-linenum> 196: </span><span class='hs-comment'>-- | /O(1)/. The cached measure of a tree.</span>
<span class=hs-linenum> 197: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Measured a##xo (Main.FingerTree a##xo b##xo))</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 198: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-conid'>Empty</span>           <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Monoid a##xo) | v == $dMonoid_a9d3}</span><span class='hs-varid'>mempty</span></a>
<span class=hs-linenum> 199: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 200: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>v</span>
<span class=hs-linenum> 201: </span>
<span class=hs-linenum> 202: </span><span class='hs-comment'>-- | Elements from left to right.</span>
<span class=hs-linenum> 203: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 204: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum> 205: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 206: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 207: </span>        <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 208: </span>
<span class=hs-linenum> 209: </span><span class='hs-cpp'>#if MIN_VERSION_base(4,8,0)</span>
<span class=hs-linenum> 210: </span>    <span class='hs-varid'>null</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum> 211: </span>    <span class='hs-varid'>null</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum> 212: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 213: </span>
<span class=hs-linenum> 214: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Eq</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 215: </span>    <span class='hs-varid'>xs</span> <span class='hs-varop'>==</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toList</span> <span class='hs-varid'>xs</span> <span class='hs-varop'>==</span> <span class='hs-varid'>toList</span> <span class='hs-varid'>ys</span>
<span class=hs-linenum> 216: </span>
<span class=hs-linenum> 217: </span><span class='hs-comment'>-- | Lexicographical order from left to right.</span>
<span class=hs-linenum> 218: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Ord</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 219: </span>    <span class='hs-varid'>compare</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>compare</span> <span class='hs-layout'>(</span><span class='hs-varid'>toList</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toList</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 220: </span>
<span class=hs-linenum> 221: </span><span class='hs-cpp'>#if !TESTING</span>
<span class=hs-linenum> 222: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Show</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 223: </span>    <span class='hs-varid'>showsPrec</span> <span class='hs-varid'>p</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>showParen</span> <span class='hs-layout'>(</span><span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>10</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum> 224: </span>        <span class='hs-varid'>showString</span> <span class='hs-str'>"fromList "</span> <span class='hs-varop'>.</span> <span class='hs-varid'>shows</span> <span class='hs-layout'>(</span><span class='hs-varid'>toList</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 225: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 226: </span>
<span class=hs-linenum> 227: </span><span class='hs-comment'>-- | Like 'fmap', but with constraints on the element types.</span>
<span class=hs-linenum> 228: </span><span class='hs-definition'>fmap'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 229: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 230: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(b##xo
 -&gt; d##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>fmap'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Main.Measured a##xo b##xo) | v == $dMeasured_a7XM}</span><span class='hs-varid'>mapTree</span></a>
<span class=hs-linenum> 231: </span>
<span class=hs-linenum> 232: </span><span class='hs-definition'>mapTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 233: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 234: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(c##xo
 -&gt; b##xo)
-&gt; (Main.FingerTree d##xo c##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>mapTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 235: </span><span class='hs-definition'>mapTree</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 236: </span><span class='hs-definition'>mapTree</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 237: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-varid'>mapDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(c##xo
 -&gt; b##xo)
-&gt; (Main.FingerTree d##xo c##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>mapTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo)
-&gt; (Main.Node c##xo a##xo)
   -&gt; (Main.Node d##xo b##xo)</span><span class='hs-varid'>mapNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-varid'>mapDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 238: </span>
<span class=hs-linenum> 239: </span><span class='hs-definition'>mapNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 240: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 241: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(c##xo
 -&gt; b##xo)
-&gt; (Main.Node d##xo c##xo)
   -&gt; (Main.Node a##xo b##xo)</span><span class='hs-definition'>mapNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 242: </span><span class='hs-definition'>mapNode</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 243: </span>
<span class=hs-linenum> 244: </span><span class='hs-definition'>mapDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 245: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(a##xo
 -&gt; b##xo)
-&gt; (Main.Digit a##xo)
   -&gt; (Main.Digit b##xo)</span><span class='hs-definition'>mapDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 246: </span><span class='hs-definition'>mapDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 247: </span><span class='hs-definition'>mapDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 248: </span><span class='hs-definition'>mapDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Four</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 249: </span>
<span class=hs-linenum> 250: </span><span class='hs-comment'>-- | Map all elements of the tree with a function that also takes the</span>
<span class=hs-linenum> 251: </span><span class='hs-comment'>-- measure of the prefix of the tree to the left of the element.</span>
<span class=hs-linenum> 252: </span><span class='hs-definition'>fmapWithPos</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 253: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 254: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; d##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>fmapWithPos</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.FingerTree d##xo c##xo)</span><span class='hs-varid'>mapWPTree</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum> 255: </span>
<span class=hs-linenum> 256: </span><span class='hs-definition'>mapWPTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 257: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 258: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>mapWPTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 259: </span><span class='hs-definition'>mapWPTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 260: </span><span class='hs-definition'>mapWPTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 261: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.Digit c##xo)</span><span class='hs-varid'>mapWPDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 262: </span>         <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-varid'>mapWPTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node d##xo c##xo)</span><span class='hs-varid'>mapWPNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>vpr</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 263: </span>         <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.Digit c##xo)</span><span class='hs-varid'>mapWPDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>vm</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 264: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 265: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a>    <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum> 266: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a>  <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a>  <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span>
<span class=hs-linenum> 267: </span>
<span class=hs-linenum> 268: </span><span class='hs-definition'>mapWPNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 269: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 270: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; d##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node c##xo d##xo)</span><span class='hs-definition'>mapWPNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 271: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 272: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 273: </span><span class='hs-definition'>mapWPNode</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 274: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 275: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 276: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 277: </span>
<span class=hs-linenum> 278: </span><span class='hs-definition'>mapWPDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 279: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.Digit c##xo)</span><span class='hs-definition'>mapWPDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 280: </span><span class='hs-definition'>mapWPDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 281: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 282: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 283: </span><span class='hs-definition'>mapWPDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 284: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 285: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 286: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 287: </span><span class='hs-definition'>mapWPDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Four</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vabc</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 288: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 289: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 290: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 291: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vabc</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 292: </span>
<span class=hs-linenum> 293: </span><span class='hs-comment'>-- | Map all elements of the tree with a function that also takes the</span>
<span class=hs-linenum> 294: </span><span class='hs-comment'>-- measure of the prefix to the left and of the suffix to the right of</span>
<span class=hs-linenum> 295: </span><span class='hs-comment'>-- the element.</span>
<span class=hs-linenum> 296: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 297: </span><span class='hs-comment'>-- @since 0.1.2.0</span>
<span class=hs-linenum> 298: </span><span class='hs-definition'>fmapWithContext</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 299: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 300: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; d##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>fmapWithContext</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>t</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.FingerTree d##xo c##xo)</span><span class='hs-varid'>mapWCTree</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>mempty</span> <span class='hs-varid'>t</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum> 301: </span>
<span class=hs-linenum> 302: </span><span class='hs-definition'>mapWCTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 303: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 304: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>mapWCTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 305: </span><span class='hs-definition'>mapWCTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 306: </span><span class='hs-definition'>mapWCTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 307: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; (Main.Digit c##xo)</span><span class='hs-varid'>mapWCDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>vmsr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 308: </span>         <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.FingerTree c##xo d##xo)</span><span class='hs-varid'>mapWCTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Node d##xo c##xo)</span><span class='hs-varid'>mapWCNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>vlp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>vsr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 309: </span>         <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; (Main.Digit c##xo)</span><span class='hs-varid'>mapWCDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>vlpm</span> <span class='hs-varid'>sf</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 310: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 311: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum> 312: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlpm</span></a>    <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vm</span>
<span class=hs-linenum> 313: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vmsr</span></a>    <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vsr</span>
<span class=hs-linenum> 314: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vsr</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>sf</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 315: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span>
<span class=hs-linenum> 316: </span>
<span class=hs-linenum> 317: </span><span class='hs-definition'>mapWCNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 318: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum> 319: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; d##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Node c##xo d##xo)</span><span class='hs-definition'>mapWCNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vr</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vb</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 320: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 321: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 322: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vb</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 323: </span><span class='hs-definition'>mapWCNode</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vbc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 324: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 325: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 326: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 327: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbc</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vc</span>
<span class=hs-linenum> 328: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vc</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 329: </span>
<span class=hs-linenum> 330: </span><span class='hs-definition'>mapWCDigit</span> <span class='hs-keyglyph'>::</span>
<span class=hs-linenum> 331: </span>    <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 332: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; (Main.Digit c##xo)</span><span class='hs-definition'>mapWCDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vr</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 333: </span><span class='hs-definition'>mapWCDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vb</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 334: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 335: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 336: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vb</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 337: </span><span class='hs-definition'>mapWCDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vbc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 338: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 339: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 340: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 341: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbc</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vc</span>
<span class=hs-linenum> 342: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vc</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 343: </span><span class='hs-definition'>mapWCDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 344: </span>    <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Four</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vbcd</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vcd</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <span class='hs-varid'>vd</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vabc</span> <span class='hs-varid'>d</span> <span class='hs-varid'>vr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 345: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 346: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 347: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 348: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vabc</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 349: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbcd</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vcd</span>
<span class=hs-linenum> 350: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vcd</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vd</span>
<span class=hs-linenum> 351: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vd</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>d</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 352: </span>
<span class=hs-linenum> 353: </span><span class='hs-comment'>-- | Like 'fmap', but safe only if the function preserves the measure.</span>
<span class=hs-linenum> 354: </span><span class='hs-definition'>unsafeFmap</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 355: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(a##xo
 -&gt; b##xo)
-&gt; (Main.FingerTree c##xo a##xo)
   -&gt; (Main.FingerTree c##xo b##xo)</span><span class='hs-definition'>unsafeFmap</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 356: </span><span class='hs-definition'>unsafeFmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 357: </span><span class='hs-definition'>unsafeFmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 358: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-varid'>mapDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(a##xo
 -&gt; b##xo)
-&gt; (Main.FingerTree c##xo a##xo)
   -&gt; (Main.FingerTree c##xo b##xo)</span><span class='hs-varid'>unsafeFmap</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Node a##xo b##xo)
-&gt; (Main.Node a##xo c##xo)</span><span class='hs-varid'>unsafeFmapNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-varid'>mapDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 359: </span>
<span class=hs-linenum> 360: </span><span class='hs-definition'>unsafeFmapNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 361: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(a##xo
 -&gt; b##xo)
-&gt; (Main.Node c##xo a##xo)
   -&gt; (Main.Node c##xo b##xo)</span><span class='hs-definition'>unsafeFmapNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-conid'>Node2</span></a> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 362: </span><span class='hs-definition'>unsafeFmapNode</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-conid'>Node3</span></a> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 363: </span>
<span class=hs-linenum> 364: </span><span class='hs-comment'>-- | Like 'traverse', but with constraints on the element types.</span>
<span class=hs-linenum> 365: </span><span class='hs-definition'>traverse'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 366: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 367: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(b##xo
 -&gt; e##xo d##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>traverse'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative a##xo) | v == $dApplicative_a84X}</span><span class='hs-varid'>traverseTree</span></a>
<span class=hs-linenum> 368: </span>
<span class=hs-linenum> 369: </span><span class='hs-definition'>traverseTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 370: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 371: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, GHC.Base.Applicative&lt;[]&gt; c##xo) =&gt;
(d##xo
 -&gt; c##xo b##xo)
-&gt; (Main.FingerTree e##xo d##xo)
   -&gt; c##xo (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>traverseTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; c##xo (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>pure</span></a> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 372: </span><span class='hs-definition'>traverseTree</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Single</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 373: </span><span class='hs-definition'>traverseTree</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 374: </span>    <a class=annot href="#"><span class=annottext>a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
      -&gt; (Main.Digit c##xo)
         -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varid'>deep</span></a> <a class=annot href="#"><span class=annottext>((Main.Digit a##xo)
 -&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
    -&gt; (Main.Digit a##xo)
       -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo (Main.Digit a##xo)
   -&gt; c##xo (Main.FingerTree b##xo (Main.Node b##xo a##xo))
            -&gt; (Main.Digit a##xo)
               -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo c##xo)
-&gt; (Main.Digit a##xo)
   -&gt; b##xo (Main.Digit c##xo)</span><span class='hs-varid'>traverseDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.FingerTree b##xo (Main.Node b##xo c##xo))
       -&gt; (Main.Digit c##xo)
          -&gt; (Main.FingerTree b##xo c##xo))
-&gt; a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
   -&gt; a##xo (Main.Digit c##xo)
            -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, GHC.Base.Applicative&lt;[]&gt; c##xo) =&gt;
(d##xo
 -&gt; c##xo b##xo)
-&gt; (Main.FingerTree e##xo d##xo)
   -&gt; c##xo (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>traverseTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo c##xo)
-&gt; (Main.Node d##xo a##xo)
   -&gt; b##xo (Main.Node e##xo c##xo)</span><span class='hs-varid'>traverseNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.Digit b##xo)
       -&gt; (Main.FingerTree c##xo b##xo))
-&gt; a##xo (Main.Digit b##xo)
   -&gt; a##xo (Main.FingerTree c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo c##xo)
-&gt; (Main.Digit a##xo)
   -&gt; b##xo (Main.Digit c##xo)</span><span class='hs-varid'>traverseDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 375: </span>
<span class=hs-linenum> 376: </span><span class='hs-definition'>traverseNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 377: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 378: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, GHC.Base.Applicative&lt;[]&gt; c##xo) =&gt;
(d##xo
 -&gt; c##xo b##xo)
-&gt; (Main.Node e##xo d##xo)
   -&gt; c##xo (Main.Node a##xo b##xo)</span><span class='hs-definition'>traverseNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varid'>node2</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 379: </span><span class='hs-definition'>traverseNode</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varid'>node3</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 380: </span>
<span class=hs-linenum> 381: </span><span class='hs-definition'>traverseDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 382: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(GHC.Base.Applicative&lt;[]&gt; a##xo) =&gt;
(b##xo
 -&gt; a##xo c##xo)
-&gt; (Main.Digit b##xo)
   -&gt; a##xo (Main.Digit c##xo)</span><span class='hs-definition'>traverseDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>One</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 383: </span><span class='hs-definition'>traverseDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Two</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 384: </span><span class='hs-definition'>traverseDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Three</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 385: </span><span class='hs-definition'>traverseDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Four</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; a##xo
          -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; a##xo
               -&gt; a##xo
                  -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; b##xo
             -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; b##xo
               -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>d</span>
<span class=hs-linenum> 386: </span>
<span class=hs-linenum> 387: </span><span class='hs-comment'>-- | Traverse the tree from left to right with a function that also</span>
<span class=hs-linenum> 388: </span><span class='hs-comment'>-- takes the measure of the prefix of the tree to the left of the element.</span>
<span class=hs-linenum> 389: </span><span class='hs-definition'>traverseWithPos</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 390: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 391: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; e##xo d##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>traverseWithPos</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; c##xo (Main.FingerTree e##xo d##xo)</span><span class='hs-varid'>traverseWPTree</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum> 392: </span>
<span class=hs-linenum> 393: </span><span class='hs-definition'>traverseWPTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 394: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 395: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; e##xo d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>traverseWPTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; c##xo (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>pure</span></a> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 396: </span><span class='hs-definition'>traverseWPTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Single</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 397: </span><span class='hs-definition'>traverseWPTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 398: </span>    <a class=annot href="#"><span class=annottext>a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
      -&gt; (Main.Digit c##xo)
         -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varid'>deep</span></a> <a class=annot href="#"><span class=annottext>((Main.Digit a##xo)
 -&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
    -&gt; (Main.Digit a##xo)
       -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo (Main.Digit a##xo)
   -&gt; c##xo (Main.FingerTree b##xo (Main.Node b##xo a##xo))
            -&gt; (Main.Digit a##xo)
               -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; c##xo (Main.Digit d##xo)</span><span class='hs-varid'>traverseWPDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.FingerTree b##xo (Main.Node b##xo c##xo))
       -&gt; (Main.Digit c##xo)
          -&gt; (Main.FingerTree b##xo c##xo))
-&gt; a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
   -&gt; a##xo (Main.Digit c##xo)
            -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; e##xo d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-varid'>traverseWPTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; c##xo (Main.Node e##xo d##xo)</span><span class='hs-varid'>traverseWPNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>vpr</span> <span class='hs-varid'>m</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.Digit b##xo)
       -&gt; (Main.FingerTree c##xo b##xo))
-&gt; a##xo (Main.Digit b##xo)
   -&gt; a##xo (Main.FingerTree c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; c##xo (Main.Digit d##xo)</span><span class='hs-varid'>traverseWPDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>vm</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 399: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 400: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a>    <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum> 401: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a>  <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a>  <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span>
<span class=hs-linenum> 402: </span>
<span class=hs-linenum> 403: </span><span class='hs-definition'>traverseWPNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 404: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 405: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; e##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; e##xo (Main.Node c##xo d##xo)</span><span class='hs-definition'>traverseWPNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varid'>node2</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 406: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 407: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 408: </span><span class='hs-definition'>traverseWPNode</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varid'>node3</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 409: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 410: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 411: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 412: </span>
<span class=hs-linenum> 413: </span><span class='hs-definition'>traverseWPDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 414: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 415: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, GHC.Base.Applicative&lt;[]&gt; c##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; c##xo (Main.Digit d##xo)</span><span class='hs-definition'>traverseWPDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>One</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 416: </span><span class='hs-definition'>traverseWPDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Two</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 417: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 418: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 419: </span><span class='hs-definition'>traverseWPDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Three</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 420: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 421: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 422: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 423: </span><span class='hs-definition'>traverseWPDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Four</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; a##xo
          -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; a##xo
               -&gt; a##xo
                  -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; b##xo
             -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; b##xo
               -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vabc</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 424: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 425: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 426: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 427: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vabc</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 428: </span>
<span class=hs-linenum> 429: </span><span class='hs-comment'>-- | Traverse the tree from left to right with a function that also</span>
<span class=hs-linenum> 430: </span><span class='hs-comment'>-- takes the measure of the prefix to the left and the measure of the</span>
<span class=hs-linenum> 431: </span><span class='hs-comment'>-- suffix to the right of the element.</span>
<span class=hs-linenum> 432: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 433: </span><span class='hs-comment'>-- @since 0.1.2.0</span>
<span class=hs-linenum> 434: </span><span class='hs-definition'>traverseWithContext</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 435: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 436: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; e##xo d##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>traverseWithContext</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>t</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; c##xo (Main.FingerTree e##xo d##xo)</span><span class='hs-varid'>traverseWCTree</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>mempty</span> <span class='hs-varid'>t</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum> 437: </span>
<span class=hs-linenum> 438: </span><span class='hs-definition'>traverseWCTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 439: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 440: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; e##xo d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-definition'>traverseWCTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; c##xo (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>pure</span></a> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 441: </span><span class='hs-definition'>traverseWCTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Single</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 442: </span><span class='hs-definition'>traverseWCTree</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 443: </span>    <a class=annot href="#"><span class=annottext>a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
      -&gt; (Main.Digit c##xo)
         -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varid'>deep</span></a> <a class=annot href="#"><span class=annottext>((Main.Digit a##xo)
 -&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
    -&gt; (Main.Digit a##xo)
       -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo (Main.Digit a##xo)
   -&gt; c##xo (Main.FingerTree b##xo (Main.Node b##xo a##xo))
            -&gt; (Main.Digit a##xo)
               -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; c##xo (Main.Digit d##xo)</span><span class='hs-varid'>traverseWCDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>vmsr</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.FingerTree b##xo (Main.Node b##xo c##xo))
       -&gt; (Main.Digit c##xo)
          -&gt; (Main.FingerTree b##xo c##xo))
-&gt; a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
   -&gt; a##xo (Main.Digit c##xo)
            -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; e##xo d##xo)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; e##xo (Main.FingerTree c##xo d##xo)</span><span class='hs-varid'>traverseWCTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; a##xo
         -&gt; c##xo (Main.Node e##xo d##xo)</span><span class='hs-varid'>traverseWCNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>vlp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>vsr</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.Digit b##xo)
       -&gt; (Main.FingerTree c##xo b##xo))
-&gt; a##xo (Main.Digit b##xo)
   -&gt; a##xo (Main.FingerTree c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; c##xo (Main.Digit d##xo)</span><span class='hs-varid'>traverseWCDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>vlpm</span> <span class='hs-varid'>sf</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 444: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 445: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum> 446: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlpm</span></a>    <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vm</span>
<span class=hs-linenum> 447: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vmsr</span></a>    <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vsr</span>
<span class=hs-linenum> 448: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vsr</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>sf</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 449: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span>
<span class=hs-linenum> 450: </span>
<span class=hs-linenum> 451: </span><span class='hs-definition'>traverseWCNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 452: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 453: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo e##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, Main.Measured&lt;[]&gt; c##xo d##xo, GHC.Base.Applicative&lt;[]&gt; e##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; e##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; a##xo
         -&gt; e##xo (Main.Node c##xo d##xo)</span><span class='hs-definition'>traverseWCNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vr</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varid'>node2</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vb</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 454: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 455: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 456: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vb</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 457: </span><span class='hs-definition'>traverseWCNode</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 458: </span>    <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varid'>node3</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vbc</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vc</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 459: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 460: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 461: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 462: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vc</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 463: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbc</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vc</span>
<span class=hs-linenum> 464: </span>
<span class=hs-linenum> 465: </span><span class='hs-definition'>traverseWCDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 466: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 467: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo, GHC.Base.Applicative&lt;[]&gt; c##xo) =&gt;
(a##xo
 -&gt; b##xo
    -&gt; a##xo
       -&gt; c##xo d##xo)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; c##xo (Main.Digit d##xo)</span><span class='hs-definition'>traverseWCDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo
   -&gt; a##xo
      -&gt; c##xo d##xo</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vr</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>One</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 468: </span><span class='hs-definition'>traverseWCDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Two</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vb</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 469: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 470: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 471: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vb</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 472: </span><span class='hs-definition'>traverseWCDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 473: </span>    <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Three</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vbc</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vc</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 474: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 475: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 476: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 477: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vc</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 478: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbc</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vc</span>
<span class=hs-linenum> 479: </span><span class='hs-definition'>traverseWCDigit</span> <span class='hs-varid'>f</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 480: </span>    <a class=annot href="#"><span class=annottext>a##xo b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-conid'>Four</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; a##xo
          -&gt; (Main.Digit a##xo))
-&gt; b##xo a##xo
   -&gt; b##xo a##xo
            -&gt; a##xo
               -&gt; a##xo
                  -&gt; (Main.Digit a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vl</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vbcd</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; b##xo
             -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; b##xo
               -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>b</span> <span class='hs-varid'>vcd</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>c</span> <span class='hs-varid'>vd</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Digit b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Digit b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo
        -&gt; a##xo
           -&gt; c##xo d##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>vabc</span> <span class='hs-varid'>d</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 481: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 482: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 483: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 484: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vabc</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 485: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vd</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>d</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 486: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vcd</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vd</span>
<span class=hs-linenum> 487: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbcd</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vcd</span>
<span class=hs-linenum> 488: </span>
<span class=hs-linenum> 489: </span><span class='hs-comment'>-- | Like 'traverse', but safe only if the function preserves the measure.</span>
<span class=hs-linenum> 490: </span><span class='hs-definition'>unsafeTraverse</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 491: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 492: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(GHC.Base.Applicative&lt;[]&gt; a##xo) =&gt;
(b##xo
 -&gt; a##xo c##xo)
-&gt; (Main.FingerTree d##xo b##xo)
   -&gt; a##xo (Main.FingerTree d##xo c##xo)</span><span class='hs-definition'>unsafeTraverse</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; c##xo (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>pure</span></a> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 493: </span><span class='hs-definition'>unsafeTraverse</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Single</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 494: </span><span class='hs-definition'>unsafeTraverse</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 495: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-varid'>v</span> <a class=annot href="#"><span class=annottext>((Main.Digit a##xo)
 -&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
    -&gt; (Main.Digit a##xo)
       -&gt; (Main.FingerTree b##xo a##xo))
-&gt; c##xo (Main.Digit a##xo)
   -&gt; c##xo (Main.FingerTree b##xo (Main.Node b##xo a##xo))
            -&gt; (Main.Digit a##xo)
               -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo c##xo)
-&gt; (Main.Digit a##xo)
   -&gt; b##xo (Main.Digit c##xo)</span><span class='hs-varid'>traverseDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.FingerTree b##xo (Main.Node b##xo c##xo))
       -&gt; (Main.Digit c##xo)
          -&gt; (Main.FingerTree b##xo c##xo))
-&gt; a##xo (Main.FingerTree b##xo (Main.Node b##xo c##xo))
   -&gt; a##xo (Main.Digit c##xo)
            -&gt; (Main.FingerTree b##xo c##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(GHC.Base.Applicative&lt;[]&gt; a##xo) =&gt;
(b##xo
 -&gt; a##xo c##xo)
-&gt; (Main.FingerTree d##xo b##xo)
   -&gt; a##xo (Main.FingerTree d##xo c##xo)</span><span class='hs-varid'>unsafeTraverse</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo c##xo)
-&gt; (Main.Node d##xo a##xo)
   -&gt; b##xo (Main.Node d##xo c##xo)</span><span class='hs-varid'>unsafeTraverseNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <a class=annot href="#"><span class=annottext>a##xo ((Main.Digit b##xo)
       -&gt; (Main.FingerTree c##xo b##xo))
-&gt; a##xo (Main.Digit b##xo)
   -&gt; a##xo (Main.FingerTree c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo c##xo)
-&gt; (Main.Digit a##xo)
   -&gt; b##xo (Main.Digit c##xo)</span><span class='hs-varid'>traverseDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 496: </span>
<span class=hs-linenum> 497: </span><span class='hs-definition'>unsafeTraverseNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Applicative</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 498: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 499: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(GHC.Base.Applicative&lt;[]&gt; a##xo) =&gt;
(b##xo
 -&gt; a##xo c##xo)
-&gt; (Main.Node d##xo b##xo)
   -&gt; a##xo (Main.Node d##xo c##xo)</span><span class='hs-definition'>unsafeTraverseNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo c##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-conid'>Node2</span></a> <span class='hs-varid'>v</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 500: </span><span class='hs-definition'>unsafeTraverseNode</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-conid'>Node3</span></a> <span class='hs-varid'>v</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; a##xo
       -&gt; (Main.Node b##xo a##xo))
-&gt; c##xo a##xo
   -&gt; c##xo a##xo
            -&gt; a##xo
               -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varop'>&lt;$&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; b##xo
          -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo b##xo
            -&gt; (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo (b##xo
       -&gt; (Main.Node c##xo b##xo))
-&gt; a##xo b##xo
   -&gt; a##xo (Main.Node c##xo b##xo)</span><span class='hs-varop'>&lt;*&gt;</span></a> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo c##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 501: </span>
<span class=hs-linenum> 502: </span><span class='hs-comment'>-----------------------------------------------------</span>
<span class=hs-linenum> 503: </span><span class='hs-comment'>-- 4.3 Construction, deconstruction and concatenation</span>
<span class=hs-linenum> 504: </span><span class='hs-comment'>-----------------------------------------------------</span>
<span class=hs-linenum> 505: </span>
<span class=hs-linenum> 506: </span><span class='hs-comment'>-- | /O(1)/. The empty sequence.</span>
<span class=hs-linenum> 507: </span><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 508: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>empty</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 509: </span>
<span class=hs-linenum> 510: </span><span class='hs-comment'>-- | /O(1)/. A singleton sequence.</span>
<span class=hs-linenum> 511: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 512: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
b##xo
-&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>singleton</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span>
<span class=hs-linenum> 513: </span>
<span class=hs-linenum> 514: </span><span class='hs-comment'>-- | /O(n)/. Create a sequence from a finite list of elements.</span>
<span class=hs-linenum> 515: </span><span class='hs-comment'>-- The opposite operation 'toList' is supplied by the 'Foldable' instance.</span>
<span class=hs-linenum> 516: </span><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 517: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
[b##xo]
-&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>fromList</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; (Main.FingerTree b##xo a##xo)
    -&gt; (Main.FingerTree b##xo a##xo))
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; [a##xo]
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>foldr</span></a> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;|</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 518: </span>
<span class=hs-linenum> 519: </span><span class='hs-comment'>-- | /O(1)/. Add an element to the left end of a sequence.</span>
<span class=hs-linenum> 520: </span><span class='hs-comment'>-- Mnemonic: a triangle with the single element at the pointy end.</span>
<span class=hs-linenum> 521: </span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;|</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 522: </span><a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-definition'>a</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
b##xo
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>&lt;|</span></a></span> <span class='hs-conid'>Empty</span>              <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 523: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>b</span>           <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 524: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`seq`</span>
<span class=hs-linenum> 525: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
b##xo
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 526: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>     <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 527: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit a##xo)</span><span class='hs-varid'>consDigit</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 528: </span>
<span class=hs-linenum> 529: </span><span class='hs-definition'>consDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 530: </span><a class=annot href="#"><span class=annottext>forall a##xo .
a##xo
-&gt; (Main.Digit a##xo)
   -&gt; (Main.Digit a##xo)</span><span class='hs-definition'>consDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 531: </span><span class='hs-definition'>consDigit</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 532: </span><span class='hs-definition'>consDigit</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Four</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 533: </span><span class='hs-definition'>consDigit</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>illegal_argument</span></a> <span class='hs-str'>"consDigit"</span>
<span class=hs-linenum> 534: </span>
<span class=hs-linenum> 535: </span><span class='hs-comment'>-- | /O(1)/. Add an element to the right end of a sequence.</span>
<span class=hs-linenum> 536: </span><span class='hs-comment'>-- Mnemonic: a triangle with the single element at the pointy end.</span>
<span class=hs-linenum> 537: </span><span class='hs-layout'>(</span><span class='hs-varop'>|&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 538: </span><span class='hs-conid'>Empty</span> <span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a></span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a>              <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 539: </span><span class='hs-conid'>Single</span> <span class='hs-varid'>a</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>b</span>           <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 540: </span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`seq`</span>
<span class=hs-linenum> 541: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 542: </span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>x</span>     <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 543: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-varid'>snocDigit</span></a> <span class='hs-varid'>sf</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 544: </span>
<span class=hs-linenum> 545: </span><span class='hs-definition'>snocDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 546: </span><a class=annot href="#"><span class=annottext>forall a##xo .
(Main.Digit a##xo)
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-definition'>snocDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 547: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 548: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Four</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 549: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>illegal_argument</span></a> <span class='hs-str'>"snocDigit"</span>
<span class=hs-linenum> 550: </span>
<span class=hs-linenum> 551: </span><span class='hs-comment'>-- | /O(1)/. Is this the empty sequence?</span>
<span class=hs-linenum> 552: </span><span class='hs-definition'>null</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 553: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.FingerTree a##xo b##xo)
-&gt; GHC.Types.Bool</span><span class='hs-definition'>null</span></a> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum> 554: </span><span class='hs-definition'>null</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum> 555: </span>
<span class=hs-linenum> 556: </span><span class='hs-comment'>-- | /O(1)/. Analyse the left end of a sequence.</span>
<span class=hs-linenum> 557: </span><span class='hs-definition'>viewl</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ViewL</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 558: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.ViewL (Main.FingerTree a##xo) b##xo)</span><span class='hs-definition'>viewl</span></a></span> <span class='hs-conid'>Empty</span>                     <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>EmptyL</span>
<span class=hs-linenum> 559: </span><span class='hs-definition'>viewl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 560: </span><span class='hs-definition'>viewl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>rotL</span></a> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 561: </span><span class='hs-definition'>viewl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>lheadDigit</span></a> <span class='hs-varid'>pr</span> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>ltailDigit</span></a> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 562: </span>
<span class=hs-linenum> 563: </span><span class='hs-definition'>rotL</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 564: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>rotL</span></a></span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>sf</span></a>      <span class='hs-keyglyph'>=</span>   <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.ViewL (Main.FingerTree a##xo) b##xo)</span><span class='hs-varid'>viewl</span></a> <span class='hs-varid'>m</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 565: </span>    <span class='hs-conid'>EmptyL</span>  <span class='hs-keyglyph'>-&gt;</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>digitToTree</span></a> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 566: </span>    <span class='hs-varid'>a</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>m'</span> <span class='hs-keyglyph'>-&gt;</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>nodeToDigit</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>m'</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 567: </span>
<span class=hs-linenum> 568: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 569: </span><a class=annot href="#"><span class=annottext>forall a##xo .
(Main.Digit a##xo)
-&gt; a##xo</span><span class='hs-definition'>lheadDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 570: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 571: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 572: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 573: </span>
<span class=hs-linenum> 574: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 575: </span><a class=annot href="#"><span class=annottext>forall a##xo .
(Main.Digit a##xo)
-&gt; (Main.Digit a##xo)</span><span class='hs-definition'>ltailDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>illegal_argument</span></a> <span class='hs-str'>"ltailDigit"</span>
<span class=hs-linenum> 576: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 577: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 578: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 579: </span>
<span class=hs-linenum> 580: </span><span class='hs-comment'>-- | /O(1)/. Analyse the right end of a sequence.</span>
<span class=hs-linenum> 581: </span><span class='hs-definition'>viewr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ViewR</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 582: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.ViewR (Main.FingerTree a##xo) b##xo)</span><span class='hs-definition'>viewr</span></a></span> <span class='hs-conid'>Empty</span>                     <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>EmptyR</span>
<span class=hs-linenum> 583: </span><span class='hs-definition'>viewr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>Empty</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 584: </span><span class='hs-definition'>viewr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Digit b##xo)
-&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>rotR</span></a> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 585: </span><span class='hs-definition'>viewr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>rtailDigit</span></a> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-conop'>:&gt;</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>rheadDigit</span></a> <span class='hs-varid'>sf</span>
<span class=hs-linenum> 586: </span>
<span class=hs-linenum> 587: </span><span class='hs-definition'>rotR</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 588: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Digit b##xo)
-&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>rotR</span></a></span> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>pr</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.ViewR (Main.FingerTree a##xo) b##xo)</span><span class='hs-varid'>viewr</span></a> <span class='hs-varid'>m</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 589: </span>    <span class='hs-conid'>EmptyR</span>  <span class='hs-keyglyph'>-&gt;</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>digitToTree</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum> 590: </span>    <span class='hs-varid'>m'</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-conid'>Deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>nodeToDigit</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 591: </span>
<span class=hs-linenum> 592: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 593: </span><a class=annot href="#"><span class=annottext>forall a##xo .
(Main.Digit a##xo)
-&gt; a##xo</span><span class='hs-definition'>rheadDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 594: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 595: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 596: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 597: </span>
<span class=hs-linenum> 598: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 599: </span><a class=annot href="#"><span class=annottext>forall a##xo .
(Main.Digit a##xo)
-&gt; (Main.Digit a##xo)</span><span class='hs-definition'>rtailDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>illegal_argument</span></a> <span class='hs-str'>"rtailDigit"</span>
<span class=hs-linenum> 600: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 601: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 602: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 603: </span>
<span class=hs-linenum> 604: </span><span class='hs-definition'>digitToTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 605: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Digit b##xo)
-&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>digitToTree</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 606: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 607: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 608: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 609: </span>
<span class=hs-linenum> 610: </span><span class='hs-comment'>----------------</span>
<span class=hs-linenum> 611: </span><span class='hs-comment'>-- Concatenation</span>
<span class=hs-linenum> 612: </span><span class='hs-comment'>----------------</span>
<span class=hs-linenum> 613: </span>
<span class=hs-linenum> 614: </span><span class='hs-comment'>-- | /O(log(min(n1,n2)))/. Concatenate two sequences.</span>
<span class=hs-linenum> 615: </span><span class='hs-layout'>(</span><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 616: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>{v : (Main.Measured a##xo b##xo) | v == $dMeasured_a8ug}</span><span class='hs-varid'>appendTree0</span></a>
<span class=hs-linenum> 617: </span>
<span class=hs-linenum> 618: </span><span class='hs-definition'>appendTree0</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 619: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>appendTree0</span></a></span> <span class='hs-conid'>Empty</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 620: </span>    <span class='hs-varid'>xs</span>
<span class=hs-linenum> 621: </span><span class='hs-definition'>appendTree0</span> <span class='hs-varid'>xs</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 622: </span>    <span class='hs-varid'>xs</span>
<span class=hs-linenum> 623: </span><span class='hs-definition'>appendTree0</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 624: </span>    <a class=annot href="#"><span class=annottext>{v : (Main.FingerTree a##xo b##xo) | v == xs}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 625: </span><span class='hs-definition'>appendTree0</span> <span class='hs-varid'>xs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 626: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == x}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 627: </span><span class='hs-definition'>appendTree0</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr1</span> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span> <span class='hs-varid'>sf2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 628: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>addDigits0</span></a> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf2</span>
<span class=hs-linenum> 629: </span>
<span class=hs-linenum> 630: </span><span class='hs-definition'>addDigits0</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 631: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-definition'>addDigits0</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m1</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m2</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 632: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree1</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 633: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 634: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree1</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 635: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 636: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 637: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 638: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 639: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 640: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree1</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 641: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 642: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 643: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 644: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 645: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 646: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 647: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 648: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 649: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 650: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 651: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 652: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 653: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 654: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 655: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 656: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 657: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 658: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 659: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 660: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 661: </span><span class='hs-definition'>addDigits0</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 662: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 663: </span>
<span class=hs-linenum> 664: </span><span class='hs-definition'>appendTree1</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 665: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>appendTree1</span></a></span> <span class='hs-conid'>Empty</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 666: </span>    <a class=annot href="#"><span class=annottext>{v : (Main.FingerTree a##xo b##xo) | v == xs}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 667: </span><span class='hs-definition'>appendTree1</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 668: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == a}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 669: </span><span class='hs-definition'>appendTree1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 670: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 671: </span><span class='hs-definition'>appendTree1</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 672: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 673: </span><span class='hs-definition'>appendTree1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr1</span> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span> <span class='hs-varid'>sf2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 674: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; (Main.Digit b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>addDigits1</span></a> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span> <span class='hs-varid'>a</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf2</span>
<span class=hs-linenum> 675: </span>
<span class=hs-linenum> 676: </span><span class='hs-definition'>addDigits1</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 677: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; (Main.Digit b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-definition'>addDigits1</span></a></span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m1</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m2</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 678: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree1</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 679: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 680: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 681: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 682: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 683: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 684: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 685: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 686: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 687: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 688: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 689: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 690: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 691: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 692: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 693: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 694: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 695: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 696: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 697: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 698: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 699: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 700: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 701: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 702: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 703: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 704: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 705: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 706: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 707: </span><span class='hs-definition'>addDigits1</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 708: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Node a##xo b##xo)
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Node a##xo b##xo)
         -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 709: </span>
<span class=hs-linenum> 710: </span><span class='hs-definition'>appendTree2</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 711: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>appendTree2</span></a></span> <span class='hs-conid'>Empty</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 712: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == a}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 713: </span><span class='hs-definition'>appendTree2</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 714: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 715: </span><span class='hs-definition'>appendTree2</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 716: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 717: </span><span class='hs-definition'>appendTree2</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 718: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 719: </span><span class='hs-definition'>appendTree2</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr1</span> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span> <span class='hs-varid'>sf2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 720: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.Digit b##xo)
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
               -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>addDigits2</span></a> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf2</span>
<span class=hs-linenum> 721: </span>
<span class=hs-linenum> 722: </span><span class='hs-definition'>addDigits2</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 723: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.Digit b##xo)
            -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
               -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-definition'>addDigits2</span></a></span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m1</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>c</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m2</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 724: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 725: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 726: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 727: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 728: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 729: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 730: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 731: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 732: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 733: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 734: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 735: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 736: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 737: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 738: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 739: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 740: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 741: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 742: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 743: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 744: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 745: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 746: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 747: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 748: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 749: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 750: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 751: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 752: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 753: </span><span class='hs-definition'>addDigits2</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 754: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 755: </span>
<span class=hs-linenum> 756: </span><span class='hs-definition'>appendTree3</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 757: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>appendTree3</span></a></span> <span class='hs-conid'>Empty</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 758: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == a}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 759: </span><span class='hs-definition'>appendTree3</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 760: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 761: </span><span class='hs-definition'>appendTree3</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 762: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 763: </span><span class='hs-definition'>appendTree3</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 764: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 765: </span><span class='hs-definition'>appendTree3</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr1</span> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span> <span class='hs-varid'>sf2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 766: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.Digit b##xo)
               -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
                  -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>addDigits3</span></a> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf2</span>
<span class=hs-linenum> 767: </span>
<span class=hs-linenum> 768: </span><span class='hs-definition'>addDigits3</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 769: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.Digit b##xo)
               -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
                  -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-definition'>addDigits3</span></a></span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m1</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>d</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m2</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 770: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 771: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 772: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 773: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 774: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 775: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 776: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 777: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 778: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 779: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 780: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 781: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 782: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 783: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 784: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 785: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 786: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 787: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 788: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 789: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 790: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 791: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 792: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 793: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 794: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 795: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 796: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 797: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 798: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 799: </span><span class='hs-definition'>addDigits3</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 800: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 801: </span>
<span class=hs-linenum> 802: </span><span class='hs-definition'>appendTree4</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 803: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>appendTree4</span></a></span> <span class='hs-conid'>Empty</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>d</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 804: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == a}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>d</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 805: </span><span class='hs-definition'>appendTree4</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 806: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>d</span>
<span class=hs-linenum> 807: </span><span class='hs-definition'>appendTree4</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 808: </span>    <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>d</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 809: </span><span class='hs-definition'>appendTree4</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 810: </span>    <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>a</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>d</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varop'>|&gt;</span></a> <span class='hs-varid'>x</span>
<span class=hs-linenum> 811: </span><span class='hs-definition'>appendTree4</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr1</span> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span> <span class='hs-varid'>sf2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 812: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; b##xo
               -&gt; (Main.Digit b##xo)
                  -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
                     -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>addDigits4</span></a> <span class='hs-varid'>m1</span> <span class='hs-varid'>sf1</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>pr2</span> <span class='hs-varid'>m2</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf2</span>
<span class=hs-linenum> 813: </span>
<span class=hs-linenum> 814: </span><span class='hs-definition'>addDigits4</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 815: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; b##xo
               -&gt; (Main.Digit b##xo)
                  -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
                     -&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-definition'>addDigits4</span></a></span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m1</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>d</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>e</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m2</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 816: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; (Main.FingerTree a##xo b##xo)
         -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree2</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 817: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 818: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 819: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 820: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 821: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 822: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 823: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 824: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 825: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 826: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 827: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 828: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 829: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 830: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 831: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 832: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 833: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 834: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 835: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 836: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 837: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 838: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 839: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 840: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; (Main.FingerTree a##xo b##xo)
            -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree3</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 841: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 842: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 843: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 844: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 845: </span><span class='hs-definition'>addDigits4</span> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 846: </span>    <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; b##xo
   -&gt; b##xo
      -&gt; b##xo
         -&gt; b##xo
            -&gt; (Main.FingerTree a##xo b##xo)
               -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>appendTree4</span></a> <span class='hs-varid'>m1</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>g</span> <span class='hs-varid'>h</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-varid'>j</span> <span class='hs-varid'>k</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>m2</span>
<span class=hs-linenum> 847: </span>
<span class=hs-linenum> 848: </span><span class='hs-comment'>----------------</span>
<span class=hs-linenum> 849: </span><span class='hs-comment'>-- 4.4 Splitting</span>
<span class=hs-linenum> 850: </span><span class='hs-comment'>----------------</span>
<span class=hs-linenum> 851: </span>
<span class=hs-linenum> 852: </span><span class='hs-comment'>-- | A result of 'search', attempting to find a point where a predicate</span>
<span class=hs-linenum> 853: </span><span class='hs-comment'>-- on splits of the sequence changes from 'False' to 'True'.</span>
<span class=hs-linenum> 854: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 855: </span><span class='hs-comment'>-- @since 0.1.2.0</span>
<span class=hs-linenum> 856: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo .
(Main.SearchResult a##xo b##xo)
-&gt; (GHC.Generics.Rep (Main.SearchResult a##xo b##xo) c##xo)</span><span class='hs-keyword'>data</span></a> <span class='hs-conid'>SearchResult</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 857: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Position</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 858: </span>        <span class='hs-comment'>-- ^ A tree opened at a particular element: the prefix to the</span>
<span class=hs-linenum> 859: </span>        <span class='hs-comment'>-- left, the element, and the suffix to the right.</span>
<span class=hs-linenum> 860: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>OnLeft</span>
<span class=hs-linenum> 861: </span>        <span class='hs-comment'>-- ^ A position to the left of the sequence, indicating that the</span>
<span class=hs-linenum> 862: </span>        <span class='hs-comment'>-- predicate is 'True' at both ends.</span>
<span class=hs-linenum> 863: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>OnRight</span>
<span class=hs-linenum> 864: </span>        <span class='hs-comment'>-- ^ A position to the right of the sequence, indicating that the</span>
<span class=hs-linenum> 865: </span>        <span class='hs-comment'>-- predicate is 'False' at both ends.</span>
<span class=hs-linenum> 866: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Nowhere</span>
<span class=hs-linenum> 867: </span>        <span class='hs-comment'>-- ^ No position in the tree, returned if the predicate is 'True'</span>
<span class=hs-linenum> 868: </span>        <span class='hs-comment'>-- at the left end and 'False' at the right end.  This will not</span>
<span class=hs-linenum> 869: </span>        <span class='hs-comment'>-- occur if the predicate in monotonic on the tree.</span>
<span class=hs-linenum> 870: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span>
<span class=hs-linenum> 871: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 706</span>
<span class=hs-linenum> 872: </span>        <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(GHC.Generics.Generic (Main.SearchResult a##xo b##xo))</span><span class='hs-conid'>Generic</span></a>
<span class=hs-linenum> 873: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 874: </span>        <span class='hs-layout'>)</span>
<span class=hs-linenum> 875: </span>
<span class=hs-linenum> 876: </span><span class='hs-comment'>-- | /O(log(min(i,n-i)))/. Search a sequence for a point where a predicate</span>
<span class=hs-linenum> 877: </span><span class='hs-comment'>-- on splits of the sequence changes from 'False' to 'True'.</span>
<span class=hs-linenum> 878: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 879: </span><span class='hs-comment'>-- The argument @p@ is a relation between the measures of the two</span>
<span class=hs-linenum> 880: </span><span class='hs-comment'>-- sequences that could be appended together to form the sequence @t@.</span>
<span class=hs-linenum> 881: </span><span class='hs-comment'>-- If the relation is 'False' at the leftmost split and 'True' at the</span>
<span class=hs-linenum> 882: </span><span class='hs-comment'>-- rightmost split, i.e.</span>
<span class=hs-linenum> 883: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 884: </span><span class='hs-comment'>-- @not (p 'mempty' ('measure' t)) &amp;&amp; p ('measure' t) 'mempty'@</span>
<span class=hs-linenum> 885: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 886: </span><span class='hs-comment'>-- then there must exist an element @x@ in the sequence such that @p@</span>
<span class=hs-linenum> 887: </span><span class='hs-comment'>-- is 'False' for the split immediately before @x@ and 'True' for the</span>
<span class=hs-linenum> 888: </span><span class='hs-comment'>-- split just after it:</span>
<span class=hs-linenum> 889: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 890: </span><span class='hs-comment'>-- &lt;&lt;images/search.svg&gt;&gt;</span>
<span class=hs-linenum> 891: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 892: </span><span class='hs-comment'>-- In this situation, @'search' p t@ returns such an element @x@ and the</span>
<span class=hs-linenum> 893: </span><span class='hs-comment'>-- pieces @l@ and @r@ of the sequence to its left and right respectively.</span>
<span class=hs-linenum> 894: </span><span class='hs-comment'>-- That is, it returns @'Position' l x r@ such that</span>
<span class=hs-linenum> 895: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 896: </span><span class='hs-comment'>-- * @l &gt;&lt; (x &lt;| r) = t@</span>
<span class=hs-linenum> 897: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 898: </span><span class='hs-comment'>-- * @not (p (measure l) (measure (x &lt;| r))@</span>
<span class=hs-linenum> 899: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 900: </span><span class='hs-comment'>-- * @p (measure (l |&gt; x)) (measure r)@</span>
<span class=hs-linenum> 901: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 902: </span><span class='hs-comment'>-- For predictable results, one should ensure that there is only one such</span>
<span class=hs-linenum> 903: </span><span class='hs-comment'>-- point, i.e. that the predicate is /monotonic/ on @t@.</span>
<span class=hs-linenum> 904: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 905: </span><span class='hs-comment'>-- @since 0.1.2.0</span>
<span class=hs-linenum> 906: </span><span class='hs-definition'>search</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 907: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SearchResult</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 908: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.SearchResult a##xo b##xo)</span><span class='hs-definition'>search</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>t</span></a>
<span class=hs-linenum> 909: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v &lt;=&gt; p_left
                            &amp;&amp; p_right}</span><span class='hs-varid'>p_left</span></a> <a class=annot href="#"><span class=annottext>{v : x1:GHC.Types.Bool
     -&gt; x2:GHC.Types.Bool
        -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1
                                       &amp;&amp; x2} | v == &amp;&amp;}</span><span class='hs-varop'>&amp;&amp;</span></a> <span class='hs-varid'>p_right</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OnLeft</span>
<span class=hs-linenum> 910: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : x1:GHC.Types.Bool
     -&gt; {v : GHC.Types.Bool | v &lt;=&gt; not x1} | v == not}</span><span class='hs-varid'>not</span></a> <span class='hs-varid'>p_left</span> <a class=annot href="#"><span class=annottext>{v : x1:GHC.Types.Bool
     -&gt; x2:GHC.Types.Bool
        -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1
                                       &amp;&amp; x2} | v == &amp;&amp;}</span><span class='hs-varop'>&amp;&amp;</span></a> <span class='hs-varid'>p_right</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (Main.FingerTree a##xo b##xo) b##xo)</span><span class='hs-varid'>searchTree</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>mempty</span> <span class='hs-varid'>t</span> <span class='hs-varid'>mempty</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 911: </span>        <span class='hs-conid'>Split</span> <span class='hs-varid'>l</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.SearchResult b##xo a##xo)</span><span class='hs-conid'>Position</span></a> <span class='hs-varid'>l</span> <span class='hs-varid'>x</span> <span class='hs-varid'>r</span>
<span class=hs-linenum> 912: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : x1:GHC.Types.Bool
     -&gt; {v : GHC.Types.Bool | v &lt;=&gt; not x1} | v == not}</span><span class='hs-varid'>not</span></a> <span class='hs-varid'>p_left</span> <a class=annot href="#"><span class=annottext>{v : x1:GHC.Types.Bool
     -&gt; x2:GHC.Types.Bool
        -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1
                                       &amp;&amp; x2} | v == &amp;&amp;}</span><span class='hs-varop'>&amp;&amp;</span></a> <a class=annot href="#"><span class=annottext>{v : x1:GHC.Types.Bool
     -&gt; {v : GHC.Types.Bool | v &lt;=&gt; not x1} | v == not}</span><span class='hs-varid'>not</span></a> <span class='hs-varid'>p_right</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OnRight</span>
<span class=hs-linenum> 913: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nowhere</span>
<span class=hs-linenum> 914: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 915: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>p_left</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; a##xo
        -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>mempty</span> <span class='hs-varid'>vt</span>
<span class=hs-linenum> 916: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>p_right</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; a##xo
        -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vt</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum> 917: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vt</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>t</span>
<span class=hs-linenum> 918: </span>
<span class=hs-linenum> 919: </span><span class='hs-comment'>-- isSplit :: (Measured v a) =&gt; (v -&gt; v -&gt; Bool) -&gt; v -&gt; a -&gt; v -&gt; Bool</span>
<span class=hs-linenum> 920: </span><span class='hs-comment'>-- isSplit p vl x vr = not (p vl (v `mappend` vr)) &amp;&amp; p (vl `mappend` v) vr</span>
<span class=hs-linenum> 921: </span><span class='hs-comment'>--   where v = measure x</span>
<span class=hs-linenum> 922: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 923: </span><span class='hs-comment'>-- property:</span>
<span class=hs-linenum> 924: </span><span class='hs-comment'>-- isSplit p vl t vr =&gt;</span>
<span class=hs-linenum> 925: </span><span class='hs-comment'>--    let Split l x r = search t in</span>
<span class=hs-linenum> 926: </span><span class='hs-comment'>--    isSplit p (vl `mappend` measure l) x (measure r `mappend` vr)</span>
<span class=hs-linenum> 927: </span>
<span class=hs-linenum> 928: </span><span class='hs-definition'>searchTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 929: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Split</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 930: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (Main.FingerTree a##xo b##xo) b##xo)</span><span class='hs-definition'>searchTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>illegal_argument</span></a> <span class='hs-str'>"searchTree"</span>
<span class=hs-linenum> 931: </span><span class='hs-definition'>searchTree</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Empty</span> <span class='hs-varid'>x</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum> 932: </span><span class='hs-definition'>searchTree</span> <span class='hs-varid'>p</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 933: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vlp</span> <span class='hs-varid'>vmsr</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-keyword'>let</span>  <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>r</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-varid'>searchDigit</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>vl</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>vmsr</span>
<span class=hs-linenum> 934: </span>                   <span class='hs-keyword'>in</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.Split (Main.FingerTree b##xo a##xo) a##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>maybe</span></a> <span class='hs-conid'>Empty</span> <span class='hs-varid'>digitToTree</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepL</span></a> <span class='hs-varid'>r</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 935: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vlpm</span> <span class='hs-varid'>vsr</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-keyword'>let</span>  <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>ml</span></a> <a class=annot href="#"><span class=annottext>(Main.Node a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>mr</span></a>  <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (Main.FingerTree a##xo b##xo) b##xo)</span><span class='hs-varid'>searchTree</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>vlp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>vsr</span>
<span class=hs-linenum> 936: </span>                        <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>r</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-varid'>searchNode</span></a> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>ml</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>mr</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vsr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 937: </span>                   <span class='hs-keyword'>in</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.Split (Main.FingerTree b##xo a##xo) a##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (GHC.Base.Maybe (Main.Digit a##xo))
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepR</span></a> <span class='hs-varid'>pr</span>  <span class='hs-varid'>ml</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepL</span></a> <span class='hs-varid'>r</span> <span class='hs-varid'>mr</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 938: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span>  <span class='hs-keyword'>let</span>  <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>r</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-varid'>searchDigit</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>vlpm</span> <span class='hs-varid'>sf</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 939: </span>                   <span class='hs-keyword'>in</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.Split (Main.FingerTree b##xo a##xo) a##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (GHC.Base.Maybe (Main.Digit a##xo))
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepR</span></a> <span class='hs-varid'>pr</span>  <span class='hs-varid'>m</span>  <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>maybe</span></a> <span class='hs-conid'>Empty</span> <span class='hs-varid'>digitToTree</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 940: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 941: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum> 942: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlpm</span></a>    <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vlp</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vm</span>
<span class=hs-linenum> 943: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vmsr</span></a>    <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vsr</span>
<span class=hs-linenum> 944: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vsr</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>sf</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 945: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span>
<span class=hs-linenum> 946: </span>
<span class=hs-linenum> 947: </span><span class='hs-definition'>searchNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 948: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Split</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 949: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-definition'>searchNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vr</span></a>
<span class=hs-linenum> 950: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; a##xo
        -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>vb</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 951: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum> 952: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 953: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 954: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vb</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 955: </span><span class='hs-definition'>searchNode</span> <span class='hs-varid'>p</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 956: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; a##xo
        -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>vbc</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 957: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; a##xo
        -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>vc</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 958: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum> 959: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 960: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 961: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 962: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vc</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 963: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbc</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vc</span>
<span class=hs-linenum> 964: </span>
<span class=hs-linenum> 965: </span><span class='hs-definition'>searchDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum> 966: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Split</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 967: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; a##xo
    -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; a##xo
         -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-definition'>searchDigit</span></a> <span class='hs-keyword'>_</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vr</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == vl}</span><span class='hs-varid'>vl</span></a> <span class='hs-varop'>`seq`</span> <a class=annot href="#"><span class=annottext>(Main.Split (GHC.Base.Maybe (Main.Digit a##xo)) a##xo)</span><span class='hs-varid'>vr</span></a> <span class='hs-varop'>`seq`</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum> 968: </span><span class='hs-definition'>searchDigit</span> <span class='hs-varid'>p</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 969: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>vb</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 970: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum> 971: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 972: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 973: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vb</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 974: </span><span class='hs-definition'>searchDigit</span> <span class='hs-varid'>p</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 975: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>vbc</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 976: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>vc</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 977: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum> 978: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 979: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 980: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 981: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbc</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vc</span>
<span class=hs-linenum> 982: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vc</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 983: </span><span class='hs-definition'>searchDigit</span> <span class='hs-varid'>p</span> <span class='hs-varid'>vl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 984: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span> <span class='hs-varid'>vbcd</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 985: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vab</span> <span class='hs-varid'>vcd</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 986: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vabc</span> <span class='hs-varid'>vd</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 987: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum> 988: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 989: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vl</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum> 990: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 991: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vabc</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 992: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vbcd</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vcd</span>
<span class=hs-linenum> 993: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vcd</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vd</span>
<span class=hs-linenum> 994: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vd</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>d</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <span class='hs-varid'>vr</span>
<span class=hs-linenum> 995: </span>
<span class=hs-linenum> 996: </span><span class='hs-comment'>-- | /O(log(min(i,n-i)))/. Split a sequence at a point where the predicate</span>
<span class=hs-linenum> 997: </span><span class='hs-comment'>-- on the accumulated measure of the prefix changes from 'False' to 'True'.</span>
<span class=hs-linenum> 998: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 999: </span><span class='hs-comment'>-- For predictable results, one should ensure that there is only one such</span>
<span class=hs-linenum>1000: </span><span class='hs-comment'>-- point, i.e. that the predicate is /monotonic/.</span>
<span class=hs-linenum>1001: </span><span class='hs-definition'>split</span> <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>1002: </span>      <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1003: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; ((Main.FingerTree a##xo b##xo), (Main.FingerTree a##xo b##xo))</span><span class='hs-definition'>split</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Empty</span><span class='hs-layout'>,</span> <span class='hs-conid'>Empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1004: </span><span class='hs-definition'>split</span> <span class='hs-varid'>p</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>1005: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>  <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varop'>&lt;|</span></a> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1006: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span>  <span class='hs-layout'>(</span><span class='hs-varid'>xs</span><span class='hs-layout'>,</span> <span class='hs-conid'>Empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1007: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1008: </span>    <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.Split (Main.FingerTree a##xo b##xo) b##xo)</span><span class='hs-varid'>splitTree</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>mempty</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>1009: </span>
<span class=hs-linenum>1010: </span><span class='hs-comment'>-- | /O(log(min(i,n-i)))/.</span>
<span class=hs-linenum>1011: </span><span class='hs-comment'>-- Given a monotonic predicate @p@, @'takeUntil' p t@ is the largest</span>
<span class=hs-linenum>1012: </span><span class='hs-comment'>-- prefix of @t@ whose measure does not satisfy @p@.</span>
<span class=hs-linenum>1013: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1014: </span><span class='hs-comment'>-- *  @'takeUntil' p t = 'fst' ('split' p t)@</span>
<span class=hs-linenum>1015: </span><span class='hs-definition'>takeUntil</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1016: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>takeUntil</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a>  <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>x1:((Main.FingerTree a##xo b##xo), (Main.FingerTree a##xo b##xo))
-&gt; {v : (Main.FingerTree a##xo b##xo) | v == fst x1}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; GHC.Types.Bool)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; ((Main.FingerTree a##xo b##xo), (Main.FingerTree a##xo b##xo))</span><span class='hs-varid'>split</span></a> <span class='hs-varid'>p</span>
<span class=hs-linenum>1017: </span>
<span class=hs-linenum>1018: </span><span class='hs-comment'>-- | /O(log(min(i,n-i)))/.</span>
<span class=hs-linenum>1019: </span><span class='hs-comment'>-- Given a monotonic predicate @p@, @'dropUntil' p t@ is the rest of @t@</span>
<span class=hs-linenum>1020: </span><span class='hs-comment'>-- after removing the largest prefix whose measure does not satisfy @p@.</span>
<span class=hs-linenum>1021: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1022: </span><span class='hs-comment'>-- * @'dropUntil' p t = 'snd' ('split' p t)@</span>
<span class=hs-linenum>1023: </span><span class='hs-definition'>dropUntil</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1024: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>dropUntil</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a>  <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>x1:((Main.FingerTree a##xo b##xo), (Main.FingerTree a##xo b##xo))
-&gt; {v : (Main.FingerTree a##xo b##xo) | v == snd x1}</span><span class='hs-varid'>snd</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; GHC.Types.Bool)
-&gt; (Main.FingerTree a##xo b##xo)
   -&gt; ((Main.FingerTree a##xo b##xo), (Main.FingerTree a##xo b##xo))</span><span class='hs-varid'>split</span></a> <span class='hs-varid'>p</span>
<span class=hs-linenum>1025: </span>
<span class=hs-linenum>1026: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Split</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Split</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span> <span class='hs-varid'>t</span>
<span class=hs-linenum>1027: </span>
<span class=hs-linenum>1028: </span><span class='hs-definition'>splitTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>1029: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Split</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1030: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.Split (Main.FingerTree a##xo b##xo) b##xo)</span><span class='hs-definition'>splitTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>illegal_argument</span></a> <span class='hs-str'>"splitTree"</span>
<span class=hs-linenum>1031: </span><span class='hs-definition'>splitTree</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Empty</span> <span class='hs-varid'>x</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum>1032: </span><span class='hs-definition'>splitTree</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1033: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vpr</span>       <span class='hs-keyglyph'>=</span>  <span class='hs-keyword'>let</span>  <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>r</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-varid'>splitDigit</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-varid'>pr</span>
<span class=hs-linenum>1034: </span>                   <span class='hs-keyword'>in</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.Split (Main.FingerTree b##xo a##xo) a##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>maybe</span></a> <span class='hs-conid'>Empty</span> <span class='hs-varid'>digitToTree</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepL</span></a> <span class='hs-varid'>r</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1035: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vm</span>        <span class='hs-keyglyph'>=</span>  <span class='hs-keyword'>let</span>  <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>ml</span></a> <a class=annot href="#"><span class=annottext>(Main.Node a##xo b##xo)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>mr</span></a>  <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.FingerTree a##xo b##xo)
      -&gt; (Main.Split (Main.FingerTree a##xo b##xo) b##xo)</span><span class='hs-varid'>splitTree</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>vpr</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>1036: </span>                        <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>r</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-varid'>splitNode</span></a> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>ml</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>1037: </span>                   <span class='hs-keyword'>in</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.Split (Main.FingerTree b##xo a##xo) a##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (GHC.Base.Maybe (Main.Digit a##xo))
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepR</span></a> <span class='hs-varid'>pr</span>  <span class='hs-varid'>ml</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepL</span></a> <span class='hs-varid'>r</span> <span class='hs-varid'>mr</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1038: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span>  <span class='hs-keyword'>let</span>  <span class='hs-conid'>Split</span> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(GHC.Base.Maybe (Main.Digit a##xo))</span><span class='hs-varid'>r</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-varid'>splitDigit</span></a> <span class='hs-varid'>p</span> <span class='hs-varid'>vm</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>1039: </span>                   <span class='hs-keyword'>in</span>   <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.Split (Main.FingerTree b##xo a##xo) a##xo)</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (GHC.Base.Maybe (Main.Digit a##xo))
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deepR</span></a> <span class='hs-varid'>pr</span>  <span class='hs-varid'>m</span>  <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>maybe</span></a> <span class='hs-conid'>Empty</span> <span class='hs-varid'>digitToTree</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1040: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1041: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a>     <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a>    <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a>  <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>pr</span>
<span class=hs-linenum>1042: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vm</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vpr</span></a>  <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a>  <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; a##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>m</span>
<span class=hs-linenum>1043: </span>
<span class=hs-linenum>1044: </span><span class='hs-definition'>deepL</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>1045: </span>    <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1046: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(GHC.Base.Maybe (Main.Digit b##xo))
-&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>deepL</span></a> <span class='hs-conid'>Nothing</span> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>sf</span></a>      <span class='hs-keyglyph'>=</span>   <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))
-&gt; (Main.Digit b##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>rotL</span></a> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>1047: </span><span class='hs-definition'>deepL</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>    <span class='hs-keyglyph'>=</span>   <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>1048: </span>
<span class=hs-linenum>1049: </span><span class='hs-definition'>deepR</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>1050: </span>    <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1051: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.Digit b##xo)
-&gt; (Main.FingerTree a##xo (Main.Node a##xo b##xo))
   -&gt; (GHC.Base.Maybe (Main.Digit b##xo))
      -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>deepR</span></a> <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)</span><span class='hs-varid'>pr</span></a> <a class=annot href="#"><span class=annottext>(Main.FingerTree a##xo (Main.Node a##xo b##xo))</span><span class='hs-varid'>m</span></a> <span class='hs-conid'>Nothing</span>      <span class='hs-keyglyph'>=</span>   <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>rotR</span></a> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>1052: </span><span class='hs-definition'>deepR</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span>   <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>1053: </span>
<span class=hs-linenum>1054: </span><span class='hs-definition'>splitNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>1055: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Split</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1056: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Node a##xo b##xo)
      -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-definition'>splitNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1057: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1058: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>1059: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1060: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum>1061: </span><span class='hs-definition'>splitNode</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1062: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1063: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; GHC.Types.Bool | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vab</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1064: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>1065: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1066: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum>1067: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum>1068: </span>
<span class=hs-linenum>1069: </span><span class='hs-definition'>splitDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>1070: </span>    <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Split</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1071: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(a##xo
 -&gt; GHC.Types.Bool)
-&gt; a##xo
   -&gt; (Main.Digit b##xo)
      -&gt; (Main.Split (GHC.Base.Maybe (Main.Digit b##xo)) b##xo)</span><span class='hs-definition'>splitDigit</span></a> <span class='hs-keyword'>_</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a##xo | VV == i}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>`seq`</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>1072: </span><span class='hs-definition'>splitDigit</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1073: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1074: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>1075: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1076: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum>1077: </span><span class='hs-definition'>splitDigit</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1078: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1079: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vab</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1080: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>1081: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1082: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum>1083: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum>1084: </span><span class='hs-definition'>splitDigit</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1085: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>va</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; false}</span><span class='hs-conid'>Split</span></a> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1086: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vab</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1087: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; GHC.Types.Bool</span><span class='hs-varid'>p</span></a> <span class='hs-varid'>vabc</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1088: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Maybe (Main.Digit a##xo)) | isJust v &lt;=&gt; true}</span><span class='hs-conid'>Split</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-conid'>Nothing</span>
<span class=hs-linenum>1089: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1090: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>i</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>a</span>
<span class=hs-linenum>1091: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>va</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum>1092: </span>    <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vabc</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo</span><span class='hs-varid'>vab</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo</span><span class='hs-varop'>`mappend`</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>measure</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum>1093: </span>
<span class=hs-linenum>1094: </span><span class='hs-comment'>------------------</span>
<span class=hs-linenum>1095: </span><span class='hs-comment'>-- Transformations</span>
<span class=hs-linenum>1096: </span><span class='hs-comment'>------------------</span>
<span class=hs-linenum>1097: </span>
<span class=hs-linenum>1098: </span><span class='hs-comment'>-- | /O(n)/. The reverse of a sequence.</span>
<span class=hs-linenum>1099: </span><span class='hs-definition'>reverse</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1100: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(Main.FingerTree a##xo b##xo)
-&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>reverse</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a##xo
 -&gt; a##xo)
-&gt; (Main.FingerTree b##xo a##xo)
   -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>reverseTree</span></a> <span class='hs-varid'>id</span>
<span class=hs-linenum>1101: </span>
<span class=hs-linenum>1102: </span><span class='hs-definition'>reverseTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>1103: </span><span class=hs-error><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(c##xo
 -&gt; b##xo)
-&gt; (Main.FingerTree d##xo c##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-definition'>reverseTree</span></a></span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum>1104: </span><span class='hs-definition'>reverseTree</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1105: </span><span class='hs-definition'>reverseTree</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1106: </span>    <a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.FingerTree b##xo (Main.Node b##xo a##xo))
   -&gt; (Main.Digit a##xo)
      -&gt; (Main.FingerTree b##xo a##xo)</span><span class='hs-varid'>deep</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-varid'>reverseDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(c##xo
 -&gt; b##xo)
-&gt; (Main.FingerTree d##xo c##xo)
   -&gt; (Main.FingerTree a##xo b##xo)</span><span class='hs-varid'>reverseTree</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(a##xo
 -&gt; b##xo)
-&gt; (Main.Node c##xo a##xo)
   -&gt; (Main.Node d##xo b##xo)</span><span class='hs-varid'>reverseNode</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Main.Digit a##xo)
-&gt; (Main.Digit b##xo)</span><span class='hs-varid'>reverseDigit</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1107: </span>
<span class=hs-linenum>1108: </span><span class='hs-definition'>reverseNode</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v1</span> <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v2</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>1109: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo c##xo d##xo .
(Main.Measured&lt;[]&gt; a##xo b##xo) =&gt;
(c##xo
 -&gt; b##xo)
-&gt; (Main.Node d##xo c##xo)
   -&gt; (Main.Node a##xo b##xo)</span><span class='hs-definition'>reverseNode</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node2</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1110: </span><span class='hs-definition'>reverseNode</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Node b##xo a##xo)</span><span class='hs-varid'>node3</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1111: </span>
<span class=hs-linenum>1112: </span><span class='hs-definition'>reverseDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>1113: </span><a class=annot href="#"><span class=annottext>forall a##xo b##xo .
(a##xo
 -&gt; b##xo)
-&gt; (Main.Digit a##xo)
   -&gt; (Main.Digit b##xo)</span><span class='hs-definition'>reverseDigit</span></a> <a class=annot href="#"><span class=annottext>a##xo
-&gt; b##xo</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1114: </span><span class='hs-definition'>reverseDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Two</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1115: </span><span class='hs-definition'>reverseDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Three</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1116: </span><span class='hs-definition'>reverseDigit</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a##xo
-&gt; a##xo
   -&gt; a##xo
      -&gt; (Main.Digit a##xo)</span><span class='hs-conid'>Four</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : a##xo
     -&gt; b##xo | v == f}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1117: </span>
<span class=hs-linenum>1118: </span><span class='hs-definition'>illegal_argument</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>1119: </span><a class=annot href="#"><span class=annottext>forall a##xo .
[GHC.Types.Char]
-&gt; a##xo</span><span class='hs-definition'>illegal_argument</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>name</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1120: </span>    <a class=annot href="#"><span class=annottext>[GHC.Types.Char]
-&gt; a##xo</span><span class='hs-varid'>error</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"Logic error: "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>name</span></a> <span class='hs-varop'>++</span> <span class='hs-str'>" called with illegal argument"</span>
<span class=hs-linenum>1121: </span>
<span class=hs-linenum>1122: </span><span class='hs-comment'>{- $example

Particular abstract data types may be implemented by defining
element types with suitable 'Measured' instances.

(from section 4.5 of the paper)
Simple sequences can be implemented using a 'Sum' monoid as a measure:

&gt; newtype Elem a = Elem { getElem :: a }
&gt;
&gt; instance Measured (Sum Int) (Elem a) where
&gt;     measure (Elem _) = Sum 1
&gt;
&gt; newtype Seq a = Seq (FingerTree (Sum Int) (Elem a))

Then the measure of a subsequence is simply its length.
This representation supports log-time extraction of subsequences:

&gt; take :: Int -&gt; Seq a -&gt; Seq a
&gt; take k (Seq xs) = Seq (takeUntil (&gt; Sum k) xs)
&gt;
&gt; drop :: Int -&gt; Seq a -&gt; Seq a
&gt; drop k (Seq xs) = Seq (dropUntil (&gt; Sum k) xs)

The module @Data.Sequence@ is an optimized instantiation of this type.

For further examples, see "Data.IntervalMap.FingerTree" and
"Data.PriorityQueue.FingerTree".

-}</span>
<span class=hs-linenum>1152: </span>
<span class=hs-linenum>1153: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>1154: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-definition'>main</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]
-&gt; (GHC.Types.IO ())</span><span class='hs-varid'>print</span></a> <span class='hs-str'>":)"</span></pre>
</body>
</html>