<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>fing.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# LANGUAGE FunctionalDependencies #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# LANGUAGE MultiParamTypeClasses #-}</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-# LANGUAGE UndecidableInstances #-}</span>
<span class=hs-linenum>  5: </span>
<span class=hs-linenum>  6: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span> <span class='hs-varop'>&gt;&lt;</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span> <span class='hs-varop'>&lt;|</span><span class='hs-layout'>,</span> <span class='hs-conop'>:&lt;</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>infixl</span> <span class='hs-num'>5</span> <span class='hs-varop'>|&gt;</span><span class='hs-layout'>,</span> <span class='hs-conop'>:&gt;</span>
<span class=hs-linenum> 11: </span>
<span class=hs-linenum> 12: </span><span class='hs-comment'>-- | View of the left end of a sequence.</span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ViewL</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 14: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyL</span>        <span class='hs-comment'>-- ^ empty sequence</span>
<span class=hs-linenum> 15: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span>      <span class='hs-comment'>-- ^ leftmost element and the rest of the sequence</span>
<span class=hs-linenum> 16: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 17: </span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>-- | View of the right end of a sequence.</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ViewR</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 20: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyR</span>        <span class='hs-comment'>-- ^ empty sequence</span>
<span class=hs-linenum> 21: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>s</span> <span class='hs-varid'>a</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>a</span>      <span class='hs-comment'>-- ^ the sequence minus the rightmost element,</span>
<span class=hs-linenum> 22: </span>                    <span class='hs-comment'>-- and the rightmost element</span>
<span class=hs-linenum> 23: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 24: </span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Functor</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Functor</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewL</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 26: </span>    <span class='hs-varid'>fmap</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>EmptyL</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyL</span>
<span class=hs-linenum> 27: </span>    <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Functor</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Functor</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewR</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 30: </span>    <span class='hs-varid'>fmap</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>EmptyR</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EmptyR</span>
<span class=hs-linenum> 31: </span>    <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>xs</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>xs</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 32: </span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Semigroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 34: </span>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 35: </span>
<span class=hs-linenum> 36: </span><span class='hs-comment'>-- | 'empty' and '&gt;&lt;'.</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Monoid</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 38: </span>    <span class='hs-varid'>mempty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>digitSize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 42: </span><span class='hs-definition'>digitSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 43: </span><span class='hs-definition'>digitSize</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum> 44: </span><span class='hs-definition'>digitSize</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>2</span>
<span class=hs-linenum> 45: </span><span class='hs-definition'>digitSize</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>3</span>
<span class=hs-linenum> 46: </span><span class='hs-definition'>digitSize</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>4</span>
<span class=hs-linenum> 47: </span>
<span class=hs-linenum> 48: </span>
<span class=hs-linenum> 49: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 50: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 51: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 52: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 53: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 54: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 55: </span>
<span class=hs-linenum> 56: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-conid'>Digit</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 57: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 58: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 59: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 60: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>c</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>d</span>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span>
<span class=hs-linenum> 63: </span>
<span class=hs-linenum> 64: </span><span class='hs-comment'>-------------------</span>
<span class=hs-linenum> 65: </span><span class='hs-comment'>-- 4.1 Measurements</span>
<span class=hs-linenum> 66: </span><span class='hs-comment'>-------------------</span>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span><span class='hs-comment'>-- | Things that can be measured.</span>
<span class=hs-linenum> 69: </span><span class='hs-keyword'>class</span> <span class='hs-layout'>(</span><span class='hs-conid'>Monoid</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 70: </span>    <span class='hs-varid'>measure</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>v</span>
<span class=hs-linenum> 71: </span>
<span class=hs-linenum> 72: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 73: </span>    <span class='hs-varid'>measure</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldMap</span> <span class='hs-varid'>measure</span>
<span class=hs-linenum> 74: </span>
<span class=hs-linenum> 75: </span><span class='hs-comment'>---------------------------</span>
<span class=hs-linenum> 76: </span><span class='hs-comment'>-- 4.2 Caching measurements</span>
<span class=hs-linenum> 77: </span><span class='hs-comment'>---------------------------</span>
<span class=hs-linenum> 78: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>nodeSize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 79: </span><span class='hs-definition'>nodeSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 80: </span><span class='hs-definition'>nodeSize</span> <span class='hs-conid'>Node2</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>2</span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>nodeSize</span> <span class='hs-conid'>Node3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>3</span>
<span class=hs-linenum> 82: </span>
<span class=hs-linenum> 83: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Node2</span> <span class='hs-varop'>!</span><span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node3</span> <span class='hs-varop'>!</span><span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 84: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 85: </span>
<span class=hs-linenum> 86: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 87: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 88: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 89: </span>
<span class=hs-linenum> 90: </span><span class='hs-definition'>node2</span>        <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 91: </span><span class='hs-definition'>node2</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>    <span class='hs-keyglyph'>=</span>   <span class='hs-conid'>Node2</span> <span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum> 92: </span>
<span class=hs-linenum> 93: </span><span class='hs-definition'>node3</span>        <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 94: </span><span class='hs-definition'>node3</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>  <span class='hs-keyglyph'>=</span>   <span class='hs-conid'>Node3</span> <span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum> 95: </span>
<span class=hs-linenum> 96: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Monoid</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 97: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>v</span>
<span class=hs-linenum> 98: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>v</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>nodeToDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{d:</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| nodeSize n == digitSize d}</span>  <span class='hs-keyword'>@-}</span> 
<span class=hs-linenum>102: </span><span class='hs-definition'>nodeToDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>103: </span><span class='hs-definition'>nodeToDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>104: </span><span class='hs-definition'>nodeToDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node3</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span><span class='hs-comment'>-- | A representation of a sequence of values of type @a@, allowing</span>
<span class=hs-linenum>107: </span><span class='hs-comment'>-- access to the ends in constant time, and append and split in time</span>
<span class=hs-linenum>108: </span><span class='hs-comment'>-- logarithmic in the size of the smaller piece.</span>
<span class=hs-linenum>109: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>110: </span><span class='hs-comment'>-- The collection is also parameterized by a measure type @v@, which</span>
<span class=hs-linenum>111: </span><span class='hs-comment'>-- is used to specify a position in the sequence for the 'split' operation.</span>
<span class=hs-linenum>112: </span><span class='hs-comment'>-- The types of the operations enforce the constraint @'Measured' v a@,</span>
<span class=hs-linenum>113: </span><span class='hs-comment'>-- which also implies that the type @v@ is determined by @a@.</span>
<span class=hs-linenum>114: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>115: </span><span class='hs-comment'>-- A variety of abstract data types can be implemented by using different</span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- element types and measurements.</span>
<span class=hs-linenum>117: </span>
<span class=hs-linenum>118: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum>119: </span>    <span class='hs-conid'>Empty</span>
<span class=hs-linenum>120: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>121: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Deep</span> <span class='hs-layout'>{</span>
<span class=hs-linenum>122: </span>        <span class='hs-sel'>_v</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>v</span><span class='hs-layout'>,</span> 
<span class=hs-linenum>123: </span>        <span class='hs-varid'>left</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>124: </span>        <span class='hs-varid'>mid</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>125: </span>        <span class='hs-varid'>right</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>126: </span>    <span class='hs-layout'>}</span>
<span class=hs-linenum>127: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>128: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>129: </span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum>130: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>131: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>132: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Show</span>
<span class=hs-linenum>133: </span>
<span class=hs-linenum>134: </span><span class='hs-comment'>-- {-@ measure fingerTreeSize @-}</span>
<span class=hs-linenum>135: </span><span class='hs-comment'>-- fingerTreeSize :: FingerTree v a -&gt; Int</span>
<span class=hs-linenum>136: </span><span class='hs-comment'>-- fingerTreeSize Empty = 0</span>
<span class=hs-linenum>137: </span><span class='hs-comment'>-- fingerTreeSize Single{} = 1</span>
<span class=hs-linenum>138: </span><span class='hs-comment'>-- fingerTreeSize (Deep _ l m r) = length l + digitSize r + fingerTreeSize m</span>
<span class=hs-linenum>139: </span>
<span class=hs-linenum>140: </span>
<span class=hs-linenum>141: </span><span class='hs-definition'>deep</span> <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<span class=hs-linenum>142: </span>     <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>143: </span><span class='hs-definition'>deep</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>144: </span>    <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>pr</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>145: </span>
<span class=hs-linenum>146: </span><span class='hs-comment'>-- | /O(1)/. The cached measure of a tree.</span>
<span class=hs-linenum>147: </span><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>148: </span>    <span class='hs-varid'>measure</span> <span class='hs-conid'>Empty</span>           <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>mempty</span>
<span class=hs-linenum>149: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>measure</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>150: </span>    <span class='hs-varid'>measure</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>v</span>
<span class=hs-linenum>151: </span>
<span class=hs-linenum>152: </span><span class='hs-comment'>-- | Elements from left to right.</span>
<span class=hs-linenum>153: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Foldable</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>154: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mempty</span>
<span class=hs-linenum>155: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>156: </span>    <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>157: </span>        <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>pr</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>foldMap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>158: </span>
<span class=hs-linenum>159: </span>
<span class=hs-linenum>160: </span><span class='hs-comment'>-- | /O(1)/. The empty sequence.</span>
<span class=hs-linenum>161: </span><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>162: </span><span class='hs-definition'>empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum>163: </span>
<span class=hs-linenum>164: </span><span class='hs-comment'>-- | /O(1)/. A singleton sequence.</span>
<span class=hs-linenum>165: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>166: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span>
<span class=hs-linenum>167: </span>
<span class=hs-linenum>168: </span><span class='hs-comment'>-- | /O(n)/. Create a sequence from a finite list of elements.</span>
<span class=hs-linenum>169: </span><span class='hs-comment'>-- The opposite operation 'toList' is supplied by the 'Foldable' instance.</span>
<span class=hs-linenum>170: </span><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>171: </span><span class='hs-definition'>fromList</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;|</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum>172: </span>
<span class=hs-linenum>173: </span><span class='hs-comment'>-- | /O(1)/. Add an element to the left end of a sequence.</span>
<span class=hs-linenum>174: </span><span class='hs-comment'>-- Mnemonic: a triangle with the single element at the pointy end.</span>
<span class=hs-linenum>175: </span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;|</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>176: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Empty</span>              <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>177: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>b</span>           <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>deep</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>178: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`seq`</span>
<span class=hs-linenum>179: </span>    <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>node3</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;|</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>180: </span><span class='hs-definition'>a</span> <span class='hs-varop'>&lt;|</span> <span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>     <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>181: </span>    <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>consDigit</span> <span class='hs-varid'>a</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>182: </span>
<span class=hs-linenum>183: </span><span class='hs-definition'>consDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>184: </span><span class='hs-definition'>consDigit</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>185: </span><span class='hs-definition'>consDigit</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>186: </span><span class='hs-definition'>consDigit</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<span class=hs-linenum>187: </span><span class='hs-definition'>consDigit</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>illegal_argument</span> <span class='hs-str'>"consDigit"</span>
<span class=hs-linenum>188: </span>
<span class=hs-linenum>189: </span><span class='hs-comment'>-- | /O(1)/. Add an element to the right end of a sequence.</span>
<span class=hs-linenum>190: </span><span class='hs-comment'>-- Mnemonic: a triangle with the single element at the pointy end.</span>
<span class=hs-linenum>191: </span><span class='hs-layout'>(</span><span class='hs-varop'>|&gt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>192: </span><span class='hs-conid'>Empty</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>a</span>              <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>193: </span><span class='hs-conid'>Single</span> <span class='hs-varid'>a</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>b</span>           <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>deep</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>194: </span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`seq`</span>
<span class=hs-linenum>195: </span>    <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>node3</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<span class=hs-linenum>196: </span><span class='hs-conid'>Deep</span> <span class='hs-varid'>v</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span> <span class='hs-varop'>|&gt;</span> <span class='hs-varid'>x</span>     <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>197: </span>    <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>snocDigit</span> <span class='hs-varid'>sf</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum>198: </span>
<span class=hs-linenum>199: </span><span class='hs-definition'>snocDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>200: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>201: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>202: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<span class=hs-linenum>203: </span><span class='hs-definition'>snocDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>illegal_argument</span> <span class='hs-str'>"snocDigit"</span>
<span class=hs-linenum>204: </span>
<span class=hs-linenum>205: </span><span class='hs-comment'>-- | /O(1)/. Is this the empty sequence?</span>
<span class=hs-linenum>206: </span><span class='hs-definition'>null</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>207: </span><span class='hs-definition'>null</span> <span class='hs-conid'>Empty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>208: </span><span class='hs-definition'>null</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>209: </span>
<span class=hs-linenum>210: </span><span class='hs-comment'>-- | /O(1)/. Analyse the left end of a sequence.</span>
<span class=hs-linenum>211: </span><span class='hs-definition'>viewl</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ViewL</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>212: </span><span class='hs-definition'>viewl</span> <span class='hs-conid'>Empty</span>                     <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>EmptyL</span>
<span class=hs-linenum>213: </span><span class='hs-definition'>viewl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-conid'>Empty</span>
<span class=hs-linenum>214: </span><span class='hs-definition'>viewl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>rotL</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>215: </span><span class='hs-definition'>viewl</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>lheadDigit</span> <span class='hs-varid'>pr</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>ltailDigit</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>216: </span>
<span class=hs-linenum>217: </span><span class='hs-definition'>rotL</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>218: </span><span class='hs-definition'>rotL</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span>      <span class='hs-keyglyph'>=</span>   <span class='hs-keyword'>case</span> <span class='hs-varid'>viewl</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>219: </span>    <span class='hs-conid'>EmptyL</span>  <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-varid'>digitToTree</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>220: </span>    <span class='hs-varid'>a</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>m'</span> <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>m</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>nodeToDigit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>m'</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>221: </span>
<span class=hs-linenum>222: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>223: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>224: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>225: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>226: </span><span class='hs-definition'>lheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>227: </span>
<span class=hs-linenum>228: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>229: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>illegal_argument</span> <span class='hs-str'>"ltailDigit"</span>
<span class=hs-linenum>230: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>231: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>232: </span><span class='hs-definition'>ltailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<span class=hs-linenum>233: </span>
<span class=hs-linenum>234: </span><span class='hs-comment'>-- | /O(1)/. Analyse the right end of a sequence.</span>
<span class=hs-linenum>235: </span><span class='hs-definition'>viewr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ViewR</span> <span class='hs-layout'>(</span><span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>236: </span><span class='hs-definition'>viewr</span> <span class='hs-conid'>Empty</span>                     <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>EmptyR</span>
<span class=hs-linenum>237: </span><span class='hs-definition'>viewr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Single</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>Empty</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>238: </span><span class='hs-definition'>viewr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>rotR</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>239: </span><span class='hs-definition'>viewr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Deep</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>deep</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>rtailDigit</span> <span class='hs-varid'>sf</span><span class='hs-layout'>)</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>rheadDigit</span> <span class='hs-varid'>sf</span>
<span class=hs-linenum>240: </span>
<span class=hs-linenum>241: </span><span class='hs-definition'>rotR</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>242: </span><span class='hs-definition'>rotR</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>viewr</span> <span class='hs-varid'>m</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>243: </span>    <span class='hs-conid'>EmptyR</span>  <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-varid'>digitToTree</span> <span class='hs-varid'>pr</span>
<span class=hs-linenum>244: </span>    <span class='hs-varid'>m'</span> <span class='hs-conop'>:&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-conid'>Deep</span> <span class='hs-layout'>(</span><span class='hs-varid'>measure</span> <span class='hs-varid'>pr</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>pr</span> <span class='hs-varid'>m'</span> <span class='hs-layout'>(</span><span class='hs-varid'>nodeToDigit</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>245: </span>
<span class=hs-linenum>246: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>247: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>248: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>249: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>250: </span><span class='hs-definition'>rheadDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>d</span>
<span class=hs-linenum>251: </span>
<span class=hs-linenum>252: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>253: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>illegal_argument</span> <span class='hs-str'>"rtailDigit"</span>
<span class=hs-linenum>254: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>One</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>255: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>256: </span><span class='hs-definition'>rtailDigit</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>257: </span>
<span class=hs-linenum>258: </span><span class='hs-definition'>digitToTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Digit</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>259: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Single</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>260: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>deep</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum>261: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>Three</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>deep</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>One</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum>262: </span><span class='hs-definition'>digitToTree</span> <span class='hs-layout'>(</span><span class='hs-conid'>Four</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>deep</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-conid'>Empty</span> <span class='hs-layout'>(</span><span class='hs-conid'>Two</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<span class=hs-linenum>263: </span>
<span class=hs-linenum>264: </span><span class='hs-layout'>(</span><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>265: </span><span class='hs-comment'>--(&gt;&lt;) =  appendTree0</span>
<span class=hs-linenum>266: </span><span class='hs-layout'>(</span><span class='hs-varop'>&gt;&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<span class=hs-linenum>267: </span>
<span class=hs-linenum>268: </span><span class='hs-comment'>-- appendTree0 :: (Measured v a) =&gt; FingerTree v a -&gt; FingerTree v a -&gt; FingerTree v a</span>
<span class=hs-linenum>269: </span><span class='hs-comment'>-- appendTree0 Empty xs =</span>
<span class=hs-linenum>270: </span><span class='hs-comment'>--     xs</span>
<span class=hs-linenum>271: </span><span class='hs-comment'>-- appendTree0 xs Empty =</span>
<span class=hs-linenum>272: </span><span class='hs-comment'>--     xs</span>
<span class=hs-linenum>273: </span><span class='hs-comment'>-- appendTree0 (Single x) xs =</span>
<span class=hs-linenum>274: </span><span class='hs-comment'>--     x &lt;| xs</span>
<span class=hs-linenum>275: </span><span class='hs-comment'>-- appendTree0 xs (Single x) =</span>
<span class=hs-linenum>276: </span><span class='hs-comment'>--     xs |&gt; x</span>
<span class=hs-linenum>277: </span><span class='hs-comment'>-- appendTree0 (Deep _ pr1 m1 sf1) (Deep _ pr2 m2 sf2) =</span>
<span class=hs-linenum>278: </span><span class='hs-comment'>--     deep pr1 (addDigits0 m1 sf1 pr2 m2) sf2</span>
<span class=hs-linenum>279: </span>
<span class=hs-linenum>280: </span><span class='hs-comment'>-- addDigits0 :: (Measured v a) =&gt; FingerTree v (Node v a) -&gt; Digit a -&gt; Digit a -&gt; FingerTree v (Node v a) -&gt; FingerTree v (Node v a)</span>
<span class=hs-linenum>281: </span><span class='hs-comment'>-- addDigits0 m1 (One a) (One b) m2 =</span>
<span class=hs-linenum>282: </span><span class='hs-comment'>--     appendTree1 m1 (node2 a b) m2</span>
<span class=hs-linenum>283: </span><span class='hs-comment'>-- addDigits0 m1 (One a) (Two b c) m2 =</span>
<span class=hs-linenum>284: </span><span class='hs-comment'>--     appendTree1 m1 (node3 a b c) m2</span>
<span class=hs-linenum>285: </span><span class='hs-comment'>-- addDigits0 m1 (One a) (Three b c d) m2 =</span>
<span class=hs-linenum>286: </span><span class='hs-comment'>--     appendTree2 m1 (node2 a b) (node2 c d) m2</span>
<span class=hs-linenum>287: </span><span class='hs-comment'>-- addDigits0 m1 (One a) (Four b c d e) m2 =</span>
<span class=hs-linenum>288: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>289: </span><span class='hs-comment'>-- addDigits0 m1 (Two a b) (One c) m2 =</span>
<span class=hs-linenum>290: </span><span class='hs-comment'>--     appendTree1 m1 (node3 a b c) m2</span>
<span class=hs-linenum>291: </span><span class='hs-comment'>-- addDigits0 m1 (Two a b) (Two c d) m2 =</span>
<span class=hs-linenum>292: </span><span class='hs-comment'>--     appendTree2 m1 (node2 a b) (node2 c d) m2</span>
<span class=hs-linenum>293: </span><span class='hs-comment'>-- addDigits0 m1 (Two a b) (Three c d e) m2 =</span>
<span class=hs-linenum>294: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>295: </span><span class='hs-comment'>-- addDigits0 m1 (Two a b) (Four c d e f) m2 =</span>
<span class=hs-linenum>296: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>297: </span><span class='hs-comment'>-- addDigits0 m1 (Three a b c) (One d) m2 =</span>
<span class=hs-linenum>298: </span><span class='hs-comment'>--     appendTree2 m1 (node2 a b) (node2 c d) m2</span>
<span class=hs-linenum>299: </span><span class='hs-comment'>-- addDigits0 m1 (Three a b c) (Two d e) m2 =</span>
<span class=hs-linenum>300: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>301: </span><span class='hs-comment'>-- addDigits0 m1 (Three a b c) (Three d e f) m2 =</span>
<span class=hs-linenum>302: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>303: </span><span class='hs-comment'>-- addDigits0 m1 (Three a b c) (Four d e f g) m2 =</span>
<span class=hs-linenum>304: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>305: </span><span class='hs-comment'>-- addDigits0 m1 (Four a b c d) (One e) m2 =</span>
<span class=hs-linenum>306: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>307: </span><span class='hs-comment'>-- addDigits0 m1 (Four a b c d) (Two e f) m2 =</span>
<span class=hs-linenum>308: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>309: </span><span class='hs-comment'>-- addDigits0 m1 (Four a b c d) (Three e f g) m2 =</span>
<span class=hs-linenum>310: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>311: </span><span class='hs-comment'>-- addDigits0 m1 (Four a b c d) (Four e f g h) m2 =</span>
<span class=hs-linenum>312: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>313: </span>
<span class=hs-linenum>314: </span><span class='hs-comment'>-- appendTree1 :: (Measured v a) =&gt; FingerTree v a -&gt; a -&gt; FingerTree v a -&gt; FingerTree v a</span>
<span class=hs-linenum>315: </span><span class='hs-comment'>-- appendTree1 Empty a xs =</span>
<span class=hs-linenum>316: </span><span class='hs-comment'>--     a &lt;| xs</span>
<span class=hs-linenum>317: </span><span class='hs-comment'>-- appendTree1 xs a Empty =</span>
<span class=hs-linenum>318: </span><span class='hs-comment'>--     xs |&gt; a</span>
<span class=hs-linenum>319: </span><span class='hs-comment'>-- appendTree1 (Single x) a xs =</span>
<span class=hs-linenum>320: </span><span class='hs-comment'>--     x &lt;| a &lt;| xs</span>
<span class=hs-linenum>321: </span><span class='hs-comment'>-- appendTree1 xs a (Single x) =</span>
<span class=hs-linenum>322: </span><span class='hs-comment'>--     xs |&gt; a |&gt; x</span>
<span class=hs-linenum>323: </span><span class='hs-comment'>-- appendTree1 (Deep _ pr1 m1 sf1) a (Deep _ pr2 m2 sf2) =</span>
<span class=hs-linenum>324: </span><span class='hs-comment'>--     deep pr1 (addDigits1 m1 sf1 a pr2 m2) sf2</span>
<span class=hs-linenum>325: </span>
<span class=hs-linenum>326: </span><span class='hs-comment'>-- addDigits1 :: (Measured v a) =&gt; FingerTree v (Node v a) -&gt; Digit a -&gt; a -&gt; Digit a -&gt; FingerTree v (Node v a) -&gt; FingerTree v (Node v a)</span>
<span class=hs-linenum>327: </span><span class='hs-comment'>-- addDigits1 m1 (One a) b (One c) m2 =</span>
<span class=hs-linenum>328: </span><span class='hs-comment'>--     appendTree1 m1 (node3 a b c) m2</span>
<span class=hs-linenum>329: </span><span class='hs-comment'>-- addDigits1 m1 (One a) b (Two c d) m2 =</span>
<span class=hs-linenum>330: </span><span class='hs-comment'>--     appendTree2 m1 (node2 a b) (node2 c d) m2</span>
<span class=hs-linenum>331: </span><span class='hs-comment'>-- addDigits1 m1 (One a) b (Three c d e) m2 =</span>
<span class=hs-linenum>332: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>333: </span><span class='hs-comment'>-- addDigits1 m1 (One a) b (Four c d e f) m2 =</span>
<span class=hs-linenum>334: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>335: </span><span class='hs-comment'>-- addDigits1 m1 (Two a b) c (One d) m2 =</span>
<span class=hs-linenum>336: </span><span class='hs-comment'>--     appendTree2 m1 (node2 a b) (node2 c d) m2</span>
<span class=hs-linenum>337: </span><span class='hs-comment'>-- addDigits1 m1 (Two a b) c (Two d e) m2 =</span>
<span class=hs-linenum>338: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>339: </span><span class='hs-comment'>-- addDigits1 m1 (Two a b) c (Three d e f) m2 =</span>
<span class=hs-linenum>340: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>341: </span><span class='hs-comment'>-- addDigits1 m1 (Two a b) c (Four d e f g) m2 =</span>
<span class=hs-linenum>342: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>343: </span><span class='hs-comment'>-- addDigits1 m1 (Three a b c) d (One e) m2 =</span>
<span class=hs-linenum>344: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>345: </span><span class='hs-comment'>-- addDigits1 m1 (Three a b c) d (Two e f) m2 =</span>
<span class=hs-linenum>346: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>347: </span><span class='hs-comment'>-- addDigits1 m1 (Three a b c) d (Three e f g) m2 =</span>
<span class=hs-linenum>348: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>349: </span><span class='hs-comment'>-- addDigits1 m1 (Three a b c) d (Four e f g h) m2 =</span>
<span class=hs-linenum>350: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>351: </span><span class='hs-comment'>-- addDigits1 m1 (Four a b c d) e (One f) m2 =</span>
<span class=hs-linenum>352: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>353: </span><span class='hs-comment'>-- addDigits1 m1 (Four a b c d) e (Two f g) m2 =</span>
<span class=hs-linenum>354: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>355: </span><span class='hs-comment'>-- addDigits1 m1 (Four a b c d) e (Three f g h) m2 =</span>
<span class=hs-linenum>356: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>357: </span><span class='hs-comment'>-- addDigits1 m1 (Four a b c d) e (Four f g h i) m2 =</span>
<span class=hs-linenum>358: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>359: </span>
<span class=hs-linenum>360: </span><span class='hs-comment'>-- appendTree2 :: (Measured v a) =&gt; FingerTree v a -&gt; a -&gt; a -&gt; FingerTree v a -&gt; FingerTree v a</span>
<span class=hs-linenum>361: </span><span class='hs-comment'>-- appendTree2 Empty a b xs =</span>
<span class=hs-linenum>362: </span><span class='hs-comment'>--     a &lt;| b &lt;| xs</span>
<span class=hs-linenum>363: </span><span class='hs-comment'>-- appendTree2 xs a b Empty =</span>
<span class=hs-linenum>364: </span><span class='hs-comment'>--     xs |&gt; a |&gt; b</span>
<span class=hs-linenum>365: </span><span class='hs-comment'>-- appendTree2 (Single x) a b xs =</span>
<span class=hs-linenum>366: </span><span class='hs-comment'>--     x &lt;| a &lt;| b &lt;| xs</span>
<span class=hs-linenum>367: </span><span class='hs-comment'>-- appendTree2 xs a b (Single x) =</span>
<span class=hs-linenum>368: </span><span class='hs-comment'>--     xs |&gt; a |&gt; b |&gt; x</span>
<span class=hs-linenum>369: </span><span class='hs-comment'>-- appendTree2 (Deep _ pr1 m1 sf1) a b (Deep _ pr2 m2 sf2) =</span>
<span class=hs-linenum>370: </span><span class='hs-comment'>--     deep pr1 (addDigits2 m1 sf1 a b pr2 m2) sf2</span>
<span class=hs-linenum>371: </span>
<span class=hs-linenum>372: </span><span class='hs-comment'>-- addDigits2 :: (Measured v a) =&gt; FingerTree v (Node v a) -&gt; Digit a -&gt; a -&gt; a -&gt; Digit a -&gt; FingerTree v (Node v a) -&gt; FingerTree v (Node v a)</span>
<span class=hs-linenum>373: </span><span class='hs-comment'>-- addDigits2 m1 (One a) b c (One d) m2 =</span>
<span class=hs-linenum>374: </span><span class='hs-comment'>--     appendTree2 m1 (node2 a b) (node2 c d) m2</span>
<span class=hs-linenum>375: </span><span class='hs-comment'>-- addDigits2 m1 (One a) b c (Two d e) m2 =</span>
<span class=hs-linenum>376: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>377: </span><span class='hs-comment'>-- addDigits2 m1 (One a) b c (Three d e f) m2 =</span>
<span class=hs-linenum>378: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>379: </span><span class='hs-comment'>-- addDigits2 m1 (One a) b c (Four d e f g) m2 =</span>
<span class=hs-linenum>380: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>381: </span><span class='hs-comment'>-- addDigits2 m1 (Two a b) c d (One e) m2 =</span>
<span class=hs-linenum>382: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>383: </span><span class='hs-comment'>-- addDigits2 m1 (Two a b) c d (Two e f) m2 =</span>
<span class=hs-linenum>384: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>385: </span><span class='hs-comment'>-- addDigits2 m1 (Two a b) c d (Three e f g) m2 =</span>
<span class=hs-linenum>386: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>387: </span><span class='hs-comment'>-- addDigits2 m1 (Two a b) c d (Four e f g h) m2 =</span>
<span class=hs-linenum>388: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>389: </span><span class='hs-comment'>-- addDigits2 m1 (Three a b c) d e (One f) m2 =</span>
<span class=hs-linenum>390: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>391: </span><span class='hs-comment'>-- addDigits2 m1 (Three a b c) d e (Two f g) m2 =</span>
<span class=hs-linenum>392: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>393: </span><span class='hs-comment'>-- addDigits2 m1 (Three a b c) d e (Three f g h) m2 =</span>
<span class=hs-linenum>394: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>395: </span><span class='hs-comment'>-- addDigits2 m1 (Three a b c) d e (Four f g h i) m2 =</span>
<span class=hs-linenum>396: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>397: </span><span class='hs-comment'>-- addDigits2 m1 (Four a b c d) e f (One g) m2 =</span>
<span class=hs-linenum>398: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>399: </span><span class='hs-comment'>-- addDigits2 m1 (Four a b c d) e f (Two g h) m2 =</span>
<span class=hs-linenum>400: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>401: </span><span class='hs-comment'>-- addDigits2 m1 (Four a b c d) e f (Three g h i) m2 =</span>
<span class=hs-linenum>402: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>403: </span><span class='hs-comment'>-- addDigits2 m1 (Four a b c d) e f (Four g h i j) m2 =</span>
<span class=hs-linenum>404: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node2 g h) (node2 i j) m2</span>
<span class=hs-linenum>405: </span>
<span class=hs-linenum>406: </span><span class='hs-comment'>-- appendTree3 :: (Measured v a) =&gt; FingerTree v a -&gt; a -&gt; a -&gt; a -&gt; FingerTree v a -&gt; FingerTree v a</span>
<span class=hs-linenum>407: </span><span class='hs-comment'>-- appendTree3 Empty a b c xs =</span>
<span class=hs-linenum>408: </span><span class='hs-comment'>--     a &lt;| b &lt;| c &lt;| xs</span>
<span class=hs-linenum>409: </span><span class='hs-comment'>-- appendTree3 xs a b c Empty =</span>
<span class=hs-linenum>410: </span><span class='hs-comment'>--     xs |&gt; a |&gt; b |&gt; c</span>
<span class=hs-linenum>411: </span><span class='hs-comment'>-- appendTree3 (Single x) a b c xs =</span>
<span class=hs-linenum>412: </span><span class='hs-comment'>--     x &lt;| a &lt;| b &lt;| c &lt;| xs</span>
<span class=hs-linenum>413: </span><span class='hs-comment'>-- appendTree3 xs a b c (Single x) =</span>
<span class=hs-linenum>414: </span><span class='hs-comment'>--     xs |&gt; a |&gt; b |&gt; c |&gt; x</span>
<span class=hs-linenum>415: </span><span class='hs-comment'>-- appendTree3 (Deep _ pr1 m1 sf1) a b c (Deep _ pr2 m2 sf2) =</span>
<span class=hs-linenum>416: </span><span class='hs-comment'>--     deep pr1 (addDigits3 m1 sf1 a b c pr2 m2) sf2</span>
<span class=hs-linenum>417: </span>
<span class=hs-linenum>418: </span><span class='hs-comment'>-- addDigits3 :: (Measured v a) =&gt; FingerTree v (Node v a) -&gt; Digit a -&gt; a -&gt; a -&gt; a -&gt; Digit a -&gt; FingerTree v (Node v a) -&gt; FingerTree v (Node v a)</span>
<span class=hs-linenum>419: </span><span class='hs-comment'>-- addDigits3 m1 (One a) b c d (One e) m2 =</span>
<span class=hs-linenum>420: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node2 d e) m2</span>
<span class=hs-linenum>421: </span><span class='hs-comment'>-- addDigits3 m1 (One a) b c d (Two e f) m2 =</span>
<span class=hs-linenum>422: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>423: </span><span class='hs-comment'>-- addDigits3 m1 (One a) b c d (Three e f g) m2 =</span>
<span class=hs-linenum>424: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>425: </span><span class='hs-comment'>-- addDigits3 m1 (One a) b c d (Four e f g h) m2 =</span>
<span class=hs-linenum>426: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>427: </span><span class='hs-comment'>-- addDigits3 m1 (Two a b) c d e (One f) m2 =</span>
<span class=hs-linenum>428: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>429: </span><span class='hs-comment'>-- addDigits3 m1 (Two a b) c d e (Two f g) m2 =</span>
<span class=hs-linenum>430: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>431: </span><span class='hs-comment'>-- addDigits3 m1 (Two a b) c d e (Three f g h) m2 =</span>
<span class=hs-linenum>432: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>433: </span><span class='hs-comment'>-- addDigits3 m1 (Two a b) c d e (Four f g h i) m2 =</span>
<span class=hs-linenum>434: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>435: </span><span class='hs-comment'>-- addDigits3 m1 (Three a b c) d e f (One g) m2 =</span>
<span class=hs-linenum>436: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>437: </span><span class='hs-comment'>-- addDigits3 m1 (Three a b c) d e f (Two g h) m2 =</span>
<span class=hs-linenum>438: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>439: </span><span class='hs-comment'>-- addDigits3 m1 (Three a b c) d e f (Three g h i) m2 =</span>
<span class=hs-linenum>440: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>441: </span><span class='hs-comment'>-- addDigits3 m1 (Three a b c) d e f (Four g h i j) m2 =</span>
<span class=hs-linenum>442: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node2 g h) (node2 i j) m2</span>
<span class=hs-linenum>443: </span><span class='hs-comment'>-- addDigits3 m1 (Four a b c d) e f g (One h) m2 =</span>
<span class=hs-linenum>444: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>445: </span><span class='hs-comment'>-- addDigits3 m1 (Four a b c d) e f g (Two h i) m2 =</span>
<span class=hs-linenum>446: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>447: </span><span class='hs-comment'>-- addDigits3 m1 (Four a b c d) e f g (Three h i j) m2 =</span>
<span class=hs-linenum>448: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node2 g h) (node2 i j) m2</span>
<span class=hs-linenum>449: </span><span class='hs-comment'>-- addDigits3 m1 (Four a b c d) e f g (Four h i j k) m2 =</span>
<span class=hs-linenum>450: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node3 g h i) (node2 j k) m2</span>
<span class=hs-linenum>451: </span>
<span class=hs-linenum>452: </span><span class='hs-comment'>-- appendTree4 :: (Measured v a) =&gt; FingerTree v a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; FingerTree v a -&gt; FingerTree v a</span>
<span class=hs-linenum>453: </span><span class='hs-comment'>-- appendTree4 Empty a b c d xs =</span>
<span class=hs-linenum>454: </span><span class='hs-comment'>--     a &lt;| b &lt;| c &lt;| d &lt;| xs</span>
<span class=hs-linenum>455: </span><span class='hs-comment'>-- appendTree4 xs a b c d Empty =</span>
<span class=hs-linenum>456: </span><span class='hs-comment'>--     xs |&gt; a |&gt; b |&gt; c |&gt; d</span>
<span class=hs-linenum>457: </span><span class='hs-comment'>-- appendTree4 (Single x) a b c d xs =</span>
<span class=hs-linenum>458: </span><span class='hs-comment'>--     x &lt;| a &lt;| b &lt;| c &lt;| d &lt;| xs</span>
<span class=hs-linenum>459: </span><span class='hs-comment'>-- appendTree4 xs a b c d (Single x) =</span>
<span class=hs-linenum>460: </span><span class='hs-comment'>--     xs |&gt; a |&gt; b |&gt; c |&gt; d |&gt; x</span>
<span class=hs-linenum>461: </span><span class='hs-comment'>-- appendTree4 (Deep _ pr1 m1 sf1) a b c d (Deep _ pr2 m2 sf2) =</span>
<span class=hs-linenum>462: </span><span class='hs-comment'>--     deep pr1 (addDigits4 m1 sf1 a b c d pr2 m2) sf2</span>
<span class=hs-linenum>463: </span>
<span class=hs-linenum>464: </span><span class='hs-comment'>-- addDigits4 :: (Measured v a) =&gt; FingerTree v (Node v a) -&gt; Digit a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Digit a -&gt; FingerTree v (Node v a) -&gt; FingerTree v (Node v a)</span>
<span class=hs-linenum>465: </span><span class='hs-comment'>-- addDigits4 m1 (One a) b c d e (One f) m2 =</span>
<span class=hs-linenum>466: </span><span class='hs-comment'>--     appendTree2 m1 (node3 a b c) (node3 d e f) m2</span>
<span class=hs-linenum>467: </span><span class='hs-comment'>-- addDigits4 m1 (One a) b c d e (Two f g) m2 =</span>
<span class=hs-linenum>468: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>469: </span><span class='hs-comment'>-- addDigits4 m1 (One a) b c d e (Three f g h) m2 =</span>
<span class=hs-linenum>470: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>471: </span><span class='hs-comment'>-- addDigits4 m1 (One a) b c d e (Four f g h i) m2 =</span>
<span class=hs-linenum>472: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>473: </span><span class='hs-comment'>-- addDigits4 m1 (Two a b) c d e f (One g) m2 =</span>
<span class=hs-linenum>474: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node2 d e) (node2 f g) m2</span>
<span class=hs-linenum>475: </span><span class='hs-comment'>-- addDigits4 m1 (Two a b) c d e f (Two g h) m2 =</span>
<span class=hs-linenum>476: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>477: </span><span class='hs-comment'>-- addDigits4 m1 (Two a b) c d e f (Three g h i) m2 =</span>
<span class=hs-linenum>478: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>479: </span><span class='hs-comment'>-- addDigits4 m1 (Two a b) c d e f (Four g h i j) m2 =</span>
<span class=hs-linenum>480: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node2 g h) (node2 i j) m2</span>
<span class=hs-linenum>481: </span><span class='hs-comment'>-- addDigits4 m1 (Three a b c) d e f g (One h) m2 =</span>
<span class=hs-linenum>482: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node2 g h) m2</span>
<span class=hs-linenum>483: </span><span class='hs-comment'>-- addDigits4 m1 (Three a b c) d e f g (Two h i) m2 =</span>
<span class=hs-linenum>484: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>485: </span><span class='hs-comment'>-- addDigits4 m1 (Three a b c) d e f g (Three h i j) m2 =</span>
<span class=hs-linenum>486: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node2 g h) (node2 i j) m2</span>
<span class=hs-linenum>487: </span><span class='hs-comment'>-- addDigits4 m1 (Three a b c) d e f g (Four h i j k) m2 =</span>
<span class=hs-linenum>488: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node3 g h i) (node2 j k) m2</span>
<span class=hs-linenum>489: </span><span class='hs-comment'>-- addDigits4 m1 (Four a b c d) e f g h (One i) m2 =</span>
<span class=hs-linenum>490: </span><span class='hs-comment'>--     appendTree3 m1 (node3 a b c) (node3 d e f) (node3 g h i) m2</span>
<span class=hs-linenum>491: </span><span class='hs-comment'>-- addDigits4 m1 (Four a b c d) e f g h (Two i j) m2 =</span>
<span class=hs-linenum>492: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node2 g h) (node2 i j) m2</span>
<span class=hs-linenum>493: </span><span class='hs-comment'>-- addDigits4 m1 (Four a b c d) e f g h (Three i j k) m2 =</span>
<span class=hs-linenum>494: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node3 g h i) (node2 j k) m2</span>
<span class=hs-linenum>495: </span><span class='hs-comment'>-- addDigits4 m1 (Four a b c d) e f g h (Four i j k l) m2 =</span>
<span class=hs-linenum>496: </span><span class='hs-comment'>--     appendTree4 m1 (node3 a b c) (node3 d e f) (node3 g h i) (node3 j k l) m2</span>
<span class=hs-linenum>497: </span>
<span class=hs-linenum>498: </span>
<span class=hs-linenum>499: </span>
<span class=hs-linenum>500: </span><span class='hs-definition'>illegal_argument</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span>
<span class=hs-linenum>501: </span>
<span class=hs-linenum>502: </span>
<span class=hs-linenum>503: </span>
<span class=hs-linenum>504: </span><span class='hs-definition'>ft1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Measured</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>FingerTree</span> <span class='hs-varid'>v</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>505: </span><span class='hs-definition'>ft1</span> <span class='hs-keyglyph'>=</span> <span class=hs-error><span class='hs-varid'>fromList</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-layout'>(</span></span><span class=hs-error><span class='hs-keyglyph'>[</span></span><span class=hs-error><span class='hs-num'>1</span></span><span class=hs-error><span class='hs-keyglyph'>..</span></span><span class=hs-error><span class='hs-num'>10</span></span><span class=hs-error><span class='hs-keyglyph'>]</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>::</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>[</span></span><span class=hs-error><span class='hs-conid'>Int</span></span><span class=hs-error><span class='hs-keyglyph'>]</span></span><span class=hs-error><span class='hs-layout'>)</span></span>
<span class=hs-linenum>506: </span>
<span class=hs-linenum>507: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>508: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>509: </span>    <span class='hs-varid'>print</span> <span class='hs-str'>"test"</span>
<span class=hs-linenum>510: </span>    <span class=hs-error><span class='hs-varid'>print</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>ft1</span></span></pre>
</body>
</html>